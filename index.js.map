{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap c7b96d84065cb513ab8a","webpack:///./src/index.ts","webpack:///./src/tools.ts","webpack:///./src/mixins.ts","webpack:///./src/messenger.ts","webpack:///./src/events-api.ts"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;ACtCA,KAAY,KAAK,uBAAM,CACvB,CAAC,CAD+B;AACvB,cAAK;AACd,8BAAc,CACd,CAAC,EADuB;AACxB,8BAAc,CACd,CAAC,EAD0B;AAC3B,KAAY,SAAS,uBAAM,CAC3B,CAAC,CADwC;AAChC,kBAAS;AAElB,oCAA4C,CAE5C,CAAC,CAFqD;AAetD,OAAM,CAAC,MAAM,GAAG,UAAE,UAAU,EAAE,WAAW,IAAM,uBAAO,CAAC,MAAM,CAAE,UAAU,EAAE,WAAW,CAAE,EAAzC,CAAyC,CAAC;AACzF,OAAM,CAAC,MAAM,IAAI,CAAE,MAAM,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAE,CAAC;AAClD,OAAM,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC;;;;;;;;ACjBvB;KA0DI;SA5CA,UAAK,GAAgB,EAAE;SAMvB,WAAM,GAAgB,EAAE;SAuCpB,IAAI,CAAC,MAAM,GAAG,OAAO,OAAO,KAAK,WAAW,GAAG,OAAO,GAAG,IAAI,CAAC;SAC9D,IAAI,CAAC,KAAK,EAAE,CAAC;KACjB,CAAC;KAjCO,uBAAS,GAAjB,UAAmB,IAAI,EAAE,IAAY;SACzB,wBAAM,EACR,SAAS,GAAG,MAAM,IAAI,MAAM,CAAE,IAAI,CAAE,CAAC;SAE3C,EAAE,EAAE,SAAU,CAAC;aAAC,SAAS,CAAC,KAAK,CAAE,MAAM,EAAE,IAAI,CAAE,CAAC;SAEhD,EAAE,EAAE,IAAI,CAAC,KAAK,CAAE,IAAI,CAAG,CAAC;aAAE,QAAQ,CAAC;SACnC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAE,IAAI,CAAG,CAAC;aAAC,MAAM,IAAI,KAAK,CAAE,MAAK,IAAI,UAAO,IAAI,CAAE,CAAC,CAAK,CAAE,CAAC;SAE1E,IAAI,CAAC,MAAM,CAAE,IAAI,CAAE,EAAE,CAAC;KAC1B,CAAC;KAGD,mBAAK,GAAL;SACI,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;SACf,IAAI,CAAC,MAAM,GAAG,EAAE,KAAK,EAAG,CAAC,EAAE,IAAI,EAAG,CAAC,EAAE,IAAI,EAAG,CAAC,EAAE,KAAK,EAAG,CAAC,EAAE,CAAC;SAC3D,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;SAChB,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAKD,uBAAS,GAAT,UAAW,aAAwB;SAC/B,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;SACf,IAAI,CAAC,KAAK,GAAG,EAAE,KAAK,EAAG,IAAI,EAAE,IAAI,EAAG,OAAO,CAAE,aAAa,CAAE,EAAE,CAAC;SAC/D,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KASD,mBAAK,GAAL;SAAO,cAAe;cAAf,WAAe,CAAf,sBAAe,CAAf,IAAe;aAAf,6BAAe;;SAClB,EAAE,EAAE,IAAI,CAAC,KAAK,GAAG,CAAE,CAAC;aAAC,IAAI,CAAC,SAAS,CAAE,OAAO,EAAE,IAAI,CAAE,CAAC;KACzD,CAAC;KAGD,kBAAI,GAAJ;SAAM,cAAe;cAAf,WAAe,CAAf,sBAAe,CAAf,IAAe;aAAf,6BAAe;;SACjB,EAAE,EAAE,IAAI,CAAC,KAAK,GAAG,CAAE,CAAC;aAAC,IAAI,CAAC,SAAS,CAAE,MAAM,EAAE,IAAI,CAAE,CAAC;KACxD,CAAC;KAGD,kBAAI,GAAJ;SAAM,cAAe;cAAf,WAAe,CAAf,sBAAe,CAAf,IAAe;aAAf,6BAAe;;SACjB,EAAE,EAAE,IAAI,CAAC,KAAK,GAAG,CAAE,CAAC;aAAC,IAAI,CAAC,SAAS,CAAE,MAAM,EAAE,IAAI,CAAE,CAAC;KACxD,CAAC;KAGD,mBAAK,GAAL;SAAO,cAAe;cAAf,WAAe,CAAf,sBAAe,CAAf,IAAe;aAAf,6BAAe;;SAClB,EAAE,EAAE,IAAI,CAAC,KAAK,GAAG,CAAE,CAAC;aAAC,IAAI,CAAC,SAAS,CAAE,OAAO,EAAE,IAAI,CAAE,CAAC;KACzD,CAAC;KAGD,sBAAI,sBAAK;cAAT;aACI,MAAM,CAAC,CAAC,kLAIE,IAAI,CAAC,MAAM,CAAC,KAAK,kBAAe,IAAI,CAAC,MAAM,CAAC,IAAI,iBAAc,IAAI,CAAC,MAAM,CAAC,IAAI,kBAAe,IAAI,CAAC,MAAM,CAAC,KAAK,kCAEzG,IAAI,CAAC,KAAK,oUAQf,IAAI,CAAC,KAAK,CAAC,KAAK,IAAI,KAAK,oBAAe,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI,KAAK,oBAAe,IAAI,CAAC,KAAK,CAAC,IAAI,IAAI,KAAK,oBAAe,IAAI,CAAC,KAAK,CAAC,KAAK,IAAI,KAAK,iGAG/I,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,KAAK,oBAAe,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,KAAK,oBAAe,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,KAAK,oBAAe,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,KAAK,UACpK,CAAC,CAAC;SACC,CAAC;;;QAAA;KACL,UAAC;AAAD,EAAC;AAzGY,YAAG,MAyGf;AAqBU,YAAG,GAAG,IAAI,GAAG,EAAE,CAAC;AAG3B,sBAA6B,KAAW;KACpC,EAAE,EAAE,KAAK,KAAK,IAAK,CAAC,EAAC;SACjB,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAED,MAAM,EAAE,OAAO,KAAM,CAAC,EAAC;SACvB,KAAK,QAAQ,CAAE;SACf,KAAK,QAAQ,CAAE;SACf,KAAK,SAAS;aACV,MAAM,CAAC,IAAI,CAAC;SAEhB,KAAK,QAAQ;aACT,IAAI,KAAK,GAAG,MAAM,CAAC,cAAc,CAAE,KAAK,CAAE,CAAC;aAE3C,EAAE,EAAE,KAAK,KAAK,MAAM,CAAC,SAAS,IAAI,KAAK,KAAK,KAAK,CAAC,SAAU,CAAC,EAAC;iBAC1D,MAAM,CAAC,KAAK,CAAE,KAAK,EAAE,WAAW,CAAE,CAAC;aACvC,CAAC;KACL,CAAC;KAED,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AApBe,oBAAW,cAoB1B;AAMD,uBAA8B,KAAgB;KAC1C,MAAM,CAAC,MAAM,CAAC,cAAc,CAAE,KAAK,CAAC,SAAS,CAAE,CAAC,WAAW;AAC/D,EAAC;AAFe,qBAAY,eAE3B;AAOD,4BAAmC,IAAe;KAAE,eAAmB;UAAnB,WAAmB,CAAnB,sBAAmB,CAAnB,IAAmB;SAAnB,8BAAmB;;KACnE,IAAM,IAAI,GAAG,YAAY,CAAE,IAAI,CAAE,EAC3B,KAAK,GAAG,EAAE,CAAC;KAEjB,GAAG,EAAc,UAAK,EAAL,eAAK,EAAL,mBAAK,EAAL,IAAM,CAAC;SAAnB,IAAI,MAAI;SACT,IAAM,KAAK,GAAG,IAAI,CAAE,MAAI,CAAE,CAAC;SAC3B,EAAE,EAAE,KAAK,KAAK,KAAK,CAAC,IAAI,KAAK,KAAK,IAAI,CAAE,MAAI,CAAG,CAAC,EAAC;aAC7C,KAAK,CAAE,MAAI,CAAE,GAAG,KAAK,CAAC;SAC1B,CAAC;MACJ;KAED,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AAZe,0BAAiB,oBAYhC;AAGD,kBAAyB,GAAQ;KAC7B,EAAE,EAAE,GAAI,CAAC,EAAC;SACN,GAAG,EAAE,IAAI,GAAG,IAAI,GAAI,CAAC,EAAC;aAClB,EAAE,EAAE,GAAG,CAAC,cAAc,CAAE,GAAG,CAAG,CAAC,EAAC;iBAC5B,MAAM,CAAC,KAAK,CAAC;aACjB,CAAC;SACL,CAAC;KACL,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAVe,gBAAO,UAUtB;AAKD,oBAAoB,GAAW,EAAE,GAAc;KAC3C,IAAI,MAAM,CAAC;KAEX,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;SAClC,EAAE,EAAE,MAAM,GAAG,GAAG,CAAE,GAAG,CAAE,CAAC,CAAE,EAAE,CAAC,CAAG,CAAC,EAAC;aAC9B,MAAM,CAAC,MAAM,CAAC;SAClB,CAAC;KACL,CAAC;AACL,EAAC;AAGD,qBAAqB,GAAQ,EAAE,GAAc;KACzC,IAAI,MAAM,CAAC;KAEX,GAAG,EAAE,IAAI,GAAG,IAAI,GAAI,CAAC,EAAC;SAClB,EAAE,EAAE,GAAG,CAAC,cAAc,CAAE,GAAG,CAAG,CAAC,EAAC;aAC5B,EAAE,EAAE,MAAM,GAAG,GAAG,CAAE,GAAG,CAAE,GAAG,CAAE,EAAE,GAAG,CAAG,CAAC,EAAC;iBAClC,MAAM,CAAC,MAAM,CAAC;aAClB,CAAC;SACL,CAAC;KACL,CAAC;AACL,EAAC;AAGD,eAAsB,GAAG,EAAE,GAAc;KACrC,EAAE,EAAE,MAAM,CAAC,cAAc,CAAE,GAAG,CAAE,KAAK,UAAW,CAAC,EAAC;SAC9C,MAAM,CAAC,SAAS,CAAE,GAAG,EAAE,GAAG,CAAE,CAAC;KACjC,CAAC;KACD,IAAI,EAAC;SACD,MAAM,CAAC,UAAU,CAAE,GAAG,EAAE,GAAG,CAAE,CAAC;KAClC,CAAC;AACL,EAAC;AAPe,aAAI,OAOnB;AAGD,gBAAuB,GAAS,EAAE,SAAoB;KAClD,MAAM,CAAC,CAAC,IAAI,CAAE,GAAG,EAAE,WAAC,IAAI,QAAC,SAAS,CAAE,CAAC,CAAE,EAAf,CAAe,CAAE,CAAC;AAC9C,EAAC;AAFe,cAAK,QAEpB;AAGD,gCAAuC,GAAQ,EAAE,IAAa;KAC1D,IAAI,IAAyB,CAAC;KAE9B,GAAG,EAAE,IAAI,KAAK,GAAG,GAAG,EAAE,CAAC,IAAI,IAAI,KAAK,EAAE,KAAK,GAAG,MAAM,CAAC,cAAc,CAAE,KAAK,CAAE,EAAG,CAAC;SAC5E,IAAI,GAAG,MAAM,CAAC,wBAAwB,CAAE,GAAG,EAAE,IAAI,CAAE,CAAC;KACxD,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AARe,8BAAqB,wBAQpC;AAID,eAAsB,MAAM;KACxB,IAAM,IAAI,GAAG,EAAE,EAAE,OAAO,GAAG,EAAE,CAAC;KAE9B,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAG,EAAE,CAAC;SACzC,OAAO,CAAE,SAAS,CAAE,CAAC,CAAE,CAAE,GAAG,IAAI,CAAC;KACrC,CAAC;KAED,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,EAAE,EAAE,CAAC,OAAO,CAAE,IAAI,CAAE,IAAI,MAAM,CAAC,cAAc,CAAE,IAAI,CAAG,CAAC,CAAC,CAAC;aACrD,IAAI,CAAE,IAAI,CAAE,GAAG,MAAM,CAAE,IAAI,CAAE,CAAC;SAClC,CAAC;KACL,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAde,aAAI,OAcnB;AAKD,oBAAmC,IAA+B,EAAE,MAAiC,EAAE,GAA6C;KAChJ,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,EAAE,EAAE,MAAM,CAAC,cAAc,CAAE,IAAI,CAAG,CAAC,CAAC,CAAC;aACjC,IAAI,KAAK,GAAG,GAAG,CAAE,MAAM,CAAE,IAAI,CAAE,EAAE,IAAI,CAAE,CAAC;aACxC,KAAK,KAAK,KAAK,CAAC,IAAI,CAAE,IAAI,CAAE,IAAI,CAAE,GAAQ,KAAK,CAAE,CAAC;SACtD,CAAC;KACL,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AATe,kBAAS,YASxB;AAGD,qBAAoC,IAAQ,EAAE,MAAU;KACpD,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,IAAI,CAAE,IAAI,CAAE,GAAG,MAAM,CAAE,IAAI,CAAE,CAAC;KAClC,CAAC;KAED,MAAM,CAAS,IAAI,CAAC;AACxB,EAAC;AANe,mBAAU,aAMzB;AAGD,uBAAoC,IAAQ,EAAE,MAAU;KACpD,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,EAAE,EAAE,IAAI,CAAE,IAAI,CAAE,KAAK,KAAK,CAAE,CAAC,EAAC;aAC1B,IAAI,CAAE,IAAI,CAAE,GAAG,MAAM,CAAE,IAAI,CAAE,CAAC;SAClC,CAAC;KACL,CAAC;KAED,MAAM,CAAS,IAAI,CAAC;AACxB,EAAC;AARe,qBAAY,eAQ3B;AAID,iBAA6B,IAAQ,EAAE,MAAe;KAClD,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,EAAE,EAAE,MAAM,CAAC,cAAc,CAAE,IAAI,CAAG,CAAC,CAAC,CAAC;aACjC,IAAI,CAAE,IAAI,CAAE,GAAG,MAAM,CAAE,IAAI,CAAE,CAAC;SAClC,CAAC;KACL,CAAC;KAED,EAAE,EAAE,SAAS,CAAC,MAAM,GAAG,CAAE,CAAC,EAAC;SACvB,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aACxC,IAAM,KAAK,GAAG,SAAS,CAAE,CAAC,CAAE,CAAC;aAC7B,KAAK,IAAI,MAAM,CAAE,IAAI,EAAE,KAAK,CAAE,CAAC;SACnC,CAAC;KACL,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAfe,eAAM,SAerB;AAID,mBAA+B,IAAQ,EAAE,MAAe;KACpD,GAAG,EAAE,IAAI,IAAI,IAAI,MAAO,CAAC,CAAC,CAAC;SACvB,EAAE,EAAE,MAAM,CAAC,cAAc,CAAE,IAAI,CAAE,IAAI,IAAI,CAAE,IAAI,CAAE,KAAK,KAAK,CAAE,CAAC,CAAC,CAAC;aAC5D,IAAI,CAAE,IAAI,CAAE,GAAG,MAAM,CAAE,IAAI,CAAE,CAAC;SAClC,CAAC;KACL,CAAC;KAED,EAAE,EAAE,SAAS,CAAC,MAAM,GAAG,CAAE,CAAC,EAAC;SACvB,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aACxC,IAAM,KAAK,GAAG,SAAS,CAAE,CAAC,CAAE,CAAC;aAC7B,KAAK,IAAI,QAAQ,CAAE,IAAI,EAAE,KAAK,CAAE,CAAC;SACrC,CAAC;KACL,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAfe,iBAAQ,WAevB;AAGD,eAAsB,CAAO;KACzB,MAAM,CAAC,CAAC,GAAG,MAAM,CAAC,IAAI,CAAE,CAAC,CAAE,GAAG,EAAE,CAAC;AACrC,EAAC;AAFe,aAAI,OAEnB;AAGD,eAAsB,IAAe;KACjC,IAAI,IAAI,EAAE,KAAK,GAAG,IAAI,CAAC;KACvB,MAAM,CAAC;SACH,EAAE,CAAC,CAAE,KAAM,CAAC,CAAC,CAAC;aACV,KAAK,GAAG,KAAK,CAAC;aACd,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;aACnC,IAAI,GAAG,IAAI,CAAC;SAChB,CAAC;SACD,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC,CAAC;AACN,EAAC;AAVe,aAAI,OAUnB;AAED,KAAM,UAAU,GAAG,KAAK,CAAC,SAAS,EAC5B,SAAS,GAAG,IAAI,CAAC,SAAS,EAC1B,WAAW,GAAG,MAAM,CAAC,SAAS,CAAC;AAOrC,mBAA0B,CAAO,EAAE,CAAO;KACtC,EAAE,EAAE,CAAC,KAAK,CAAE,CAAC;SAAC,MAAM,CAAC,KAAK,CAAC;KAE3B,EAAE,EAAE,CAAC,IAAI,CAAC,IAAI,OAAO,CAAC,IAAI,QAAQ,IAAI,OAAO,CAAC,IAAI,QAAS,CAAC,CAAC,CAAC;SAC1D,IAAM,MAAM,GAAG,MAAM,CAAC,cAAc,CAAE,CAAC,CAAE,CAAC;SAE1C,EAAE,EAAE,MAAM,KAAK,MAAM,CAAC,cAAc,CAAE,CAAC,CAAG,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;SAExD,MAAM,EAAE,MAAO,CAAC,EAAC;aACb,KAAK,SAAS,EAAK,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;aACpC,KAAK,UAAU,EAAI,MAAM,CAAC,cAAc,CAAE,CAAC,EAAE,CAAC,CAAE,CAAC;aACjD,KAAK,WAAW,CAAE;aAClB,KAAK,IAAI;iBACL,MAAM,CAAC,eAAe,CAAE,CAAC,EAAE,CAAC,CAAE,CAAC;SACvC,CAAC;KACL,CAAC;KAED,MAAM,CAAC,IAAI,CAAC;AAChB,EAAC;AAlBe,iBAAQ,WAkBvB;AAGD,0BAA0B,CAAC,EAAE,CAAC;KAC1B,IAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAE,CAAC,CAAE,CAAC;KAE/B,EAAE,EAAE,KAAK,CAAC,MAAM,KAAK,MAAM,CAAC,IAAI,CAAE,CAAC,CAAE,CAAC,MAAO,CAAC;SAAC,MAAM,CAAC,IAAI,CAAC;KAE3D,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAG,CAAC;SACrC,IAAM,GAAG,GAAG,KAAK,CAAE,CAAC,CAAE,CAAC;SAEvB,EAAE,EAAE,CAAC,CAAC,CAAC,cAAc,CAAE,GAAG,CAAE,IAAI,QAAQ,CAAE,CAAC,CAAE,GAAG,CAAE,EAAE,CAAC,CAAE,GAAG,CAAE,CAAG,CAAC,CAAC,CAAC;aAC9D,MAAM,CAAC,IAAI,CAAC;SAChB,CAAC;KACL,CAAC;KAED,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;AAGD,yBAAyB,CAAC,EAAE,CAAC;KACzB,EAAE,EAAE,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,MAAO,CAAC;SAAC,MAAM,CAAC,IAAI,CAAC;KAExC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,EAAG,CAAC;SACjC,EAAE,EAAE,QAAQ,CAAE,CAAC,CAAE,CAAC,CAAE,EAAE,CAAC,CAAE,CAAC,CAAE,CAAG,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;KACjD,CAAC;KAED,MAAM,CAAC,KAAK,CAAC;AACjB,EAAC;;;;;;;;;;;;;ACxZD,mCAA4F,CAK5F,CAAC,CALoG;AA2ErG;KAAA;KA+JA,CAAC;KA7JU,cAAM,GAAb,UAAe,CAAO,EAAE,CAAQ;SAC5B,MAAM,CAAC,IAAU,IAAK,CAAE,CAAC,EAAE,CAAC,CAAE,CAAC;KACnC,CAAC;KAkBM,cAAM,GAAb;SAAe,gBAAiC;cAAjC,WAAiC,CAAjC,sBAAiC,CAAjC,IAAiC;aAAjC,+BAAiC;;SAC5C,IAAM,KAAK,GAAQ,IAAI,CAAC,SAAS,EAC3B,UAAU,GAAgB,IAAI,CAAC,WAAW,IAAI,EAAE,EAChD,cAAc,GAAG,IAAI,CAAC,cAAc,GAAG,CAAE,IAAI,CAAC,cAAc,IAAI,EAAE,CAAE,CAAC,KAAK,EAAE,CAAC;SAGnF,GAAG,EAAe,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;aAArB,IAAI,KAAK;aAEV,EAAE,EAAE,KAAK,YAAY,KAAM,CAAC,CAAC,CAAC;iBAC1B,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAE,IAAI,EAAE,KAAK,CAAE,CAAC;aAC/C,CAAC;aAGD,EAAE,EAAE,cAAc,CAAC,OAAO,CAAE,KAAK,CAAE,IAAI,CAAE,CAAC;iBAAC,QAAQ,CAAC;aAEpD,cAAc,CAAC,IAAI,CAAE,KAAK,CAAE,CAAC;aAG7B,EAAE,EAAE,OAAO,KAAK,KAAK,UAAW,CAAC,EAAC;iBAE9B,gBAAQ,CAAE,IAAI,EAAE,KAAK,CAAE,CAAC;iBAGxB,UAAU,CAAE,KAAK,EAAqB,KAAM,CAAC,SAAS,EAAE,UAAU,CAAE,CAAC;aACzE,CAAC;aAED,IAAI,CAAC,CAAC;iBACF,UAAU,CAAE,KAAK,EAAE,KAAK,EAAE,UAAU,CAAE,CAAC;aAC3C,CAAC;UACJ;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAMM,aAAK,GAAZ;SAAmB,cAAoB;cAApB,WAAoB,CAApB,sBAAoB,CAApB,IAAoB;aAApB,6BAAoB;;SACnC,GAAG,EAAc,UAAI,EAAJ,aAAI,EAAJ,kBAAI,EAAJ,IAAK,CAAC;aAAlB,IAAI,IAAI;aACT,OAAO,CAAC,MAAM,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;UACrC;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAKM,kBAAU,GAAjB,UAAmB,UAAuB;SACtC,IAAM,IAAI,GAAG,MAAM,CAAC,cAAc,CAAE,IAAI,CAAC,SAAS,CAAE,CAAC,WAAW,CAAC;SAEjE,EAAE,EAAE,IAAI,CAAC,WAAY,CAAC,CAAC,CAAC;aACpB,UAAU,CAAE,UAAU,EAAE,IAAI,CAAC,WAAW,CAAE,CAAC;SAC/C,CAAC;SAED,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;SAC9B,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAUM,cAAM,GAAb,UAAe,UAAiC,EAAE,WAAiB;SAApD,0BAAiC,GAAjC,eAAiC;SAE5C,EAAE,EAAE,CAAC,IAAI,CAAC,MAAO,CAAC,EAAC;aACf,WAAG,CAAC,KAAK,CAAE,6JAA6J,EAAE,UAAU,CAAE,CAAC;aACvL,MAAM,CAAC,IAAI,CAAC;SAChB,CAAC;SAED,IAAI,CAAC,SAAS,EAAE,CAAC;SAGjB,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC;SAG7B,IAAM,UAAU,GAAG,YAAI,CAAE,UAAU,EAAE,YAAY,EAAE,QAAQ,EAAE,YAAY,CAAE,EACrE,0BAA6B,EAA7B,oCAA6B,EAAE,0BAAM,EAAE,kCAAU,CAAgB;SAGvE,cAAM,CAAE,KAAK,EAAE,UAAU,CAAE,CAAC;SAC5B,cAAM,CAAE,IAAI,EAAE,WAAW,CAAE,CAAC;SAG5B,UAAU,IAAI,MAAM,CAAC,gBAAgB,CAAE,KAAK,EAAE,iBAAS,CAAE,EAAE,EAAe,UAAU,EAAE,oBAAoB,CAAE,CAAE,CAAC;SAG/G,UAAU,IAAI,IAAI,CAAC,UAAU,CAAE,UAAU,CAAE,CAAC;SAC5C,MAAM,IAAI,IAAI,CAAC,MAAM,CAAE,MAAM,CAAE,CAAC;SAEhC,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAGM,cAAM,GAAb,UAAc,IAAuB,EAAE,OAAa;SAChD,IAAI,QAAyB,CAAC;SAI9B,EAAE,EAAE,IAAI,IAAI,IAAI,CAAC,cAAc,CAAE,aAAa,CAAG,CAAC,EAAC;aAE/C,QAAQ,GAAQ,IAAI,CAAC,WAAW,CAAC;aACjC,SAAS,CAAE,QAAQ,EAAE,IAAI,CAAE,CAAC;SAChC,CAAC;SAED,IAAI,EAAC;aACD,QAAQ,GAAG;iBAAuB,4BAAI;iBAA3B;qBAAuB,8BAAI;iBAAE,CAAC;iBAAD,eAAC;aAAD,CAAC,CAAP,IAAI,EAAG,CAAC;SAC9C,CAAC;SAGD,MAAM,CAAC,IAAI,GAAG,QAAQ,CAAC,MAAM,CAAE,IAAI,EAAE,OAAO,CAAE,GAAG,QAAQ,CAAC,SAAS,EAAE,CAAC;KAC1E,CAAC;KAMM,iBAAS,GAAhB;SACI,IAAM,SAAS,GAAoB,oBAAY,CAAE,IAAI,CAAE,CAAC;SAGxD,EAAE,EAAE,SAAS,CAAC,MAAM,KAAK,IAAI,CAAC,MAAO,CAAC,CAAC,CAAC;aACpC,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;SACjC,CAAC;SAED,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC,SAAS,CAAC;SAErC,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KApJgB,mBAAW,GAAgB,EAAE,UAAU,EAAG,OAAO,EAAE,CAAC;KAwJzE,cAAC;AAAD,EAAC;AA/JY,gBAAO,UA+JnB;AAGD,+BAA+B,CAAY;KACvC,EAAE,EAAE,CAAE,CAAC,EAAC;SACJ,MAAM,CAAC,OAAO,CAAC,KAAK,UAAU,GAAG,EAAE,GAAG,EAAgB,CAAC,EAAE,GAAwB,CAAC,CAAC;KACvF,CAAC;AACL,EAAC;AAKD,qBAA4B,KAAkB;KAC1C,MAAM,CAAC,eAAe,CAAE,YAAY,EAAE,KAAK,CAAE,CAAC;AAClD,EAAC;AAFe,mBAAU,aAEzB;AAKD;KAAwB,cAAc;UAAd,WAAc,CAAd,sBAAc,CAAd,IAAc;SAAd,6BAAc;;KAClC,MAAM,CAAC,eAAe,CAAE,QAAQ,EAAE,IAAI,CAAE,CAAC;AAC7C,EAAC;AAFe,eAAM,SAErB;AAGD,qBAA4B,IAAe;KACvC,OAAO,CAAC,KAAK,CAAE,IAAI,CAAE,CAAC;AAC1B,EAAC;AAFe,mBAAU,aAEzB;AAKD,oBAA2B,WAAuC;KAC9D,WAAW,CAAC,SAAS,EAAE,CAAC;AAC5B,EAAC;AAFe,kBAAS,YAExB;AAKD,iBAAwB,IAAkD;KAEtE,EAAE,EAAE,OAAO,IAAI,KAAK,UAAW,CAAC,EAAC;SACC,IAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;KACnD,CAAC;KAED,IAAI,EAAC;SACD,MAAM,CAAC,eAAe,CAAE,QAAQ,EAAE,IAAI,CAAE,CAAC;KAC7C,CAAC;AACL,EAAC;AATe,eAAM,SASrB;AAKD,0BAA0B,IAAa,EAAE,IAAS;KAC9C,MAAM,CAAC,UAAU,IAAe;SAC5B,EAAE,EAAE,IAAI,CAAE,IAAI,CAAG,CAAC,CAAC,CAAC;aAChB,IAAI,CAAE,IAAI,CAAE,CAAE,IAAI,CAAE,CAAC;SACzB,CAAC;SACD,IAAI,CAAC,CAAC;aACF,OAAO,CAAE,IAAI,CAAE,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;SACvC,CAAC;KACL,CAAC;AACL,EAAC;AAMD,uBAAuB,CAAM,EAAE,CAAM,EAAE,KAAmB;KACtD,IAAM,CAAC,GAAG,cAAM,CAAE,EAAE,EAAE,CAAC,CAAE,CAAC;KAC1B,MAAM,CAAC,UAAU,CAAE,CAAC,EAAG,CAAC,EAAE,KAAK,CAAE,CAAC;AACtC,EAAC;AAQD,KAAM,cAAc,GAAqB;KACrC,IAAI,YAAa,CAAiB,EAAE,CAAkB;SAClD,MAAM,CAAC,UAAU,CAAK;aAClB,MAAM,CAAC,CAAC,CAAC,IAAI,CAAE,IAAI,EAAE,CAAC,CAAC,IAAI,CAAE,IAAI,EAAE,CAAC,CAAE,CAAE,CAAC;SAC7C,CAAC;KACL,CAAC;KAED,QAAQ,YAAE,CAAY,EAAE,CAAY;SAChC,MAAM,CAAC;aACH,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;aAC3B,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SAC/B,CAAC;KACL,CAAC;KAED,OAAO,YAAE,CAAY,EAAE,CAAY;SAC/B,MAAM,CAAC;aACH,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;aAC3B,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SAC/B,CAAC;KACL,CAAC;KAED,KAAK,YAAE,CAAY,EAAE,CAAY;SAC7B,MAAM,CAAC;aACH,MAAM,CAAC,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,IAAI,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SACpE,CAAC;KACL,CAAC;KAED,IAAI,YAAE,CAAY,EAAE,CAAY;SAC5B,MAAM,CAAC;aACH,MAAM,CAAC,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,IAAI,CAAC,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SACpE,CAAC;KACL,CAAC;EACJ,CAAC;AAGF,qBAAqC,MAAU,EAAE,MAAW,EAAE,KAAuB;KAAvB,qBAAuB,GAAvB,UAAuB;KACjF,GAAG,EAAc,UAAqB,EAArB,WAAM,CAAC,IAAI,CAAE,MAAM,CAAE,EAArB,cAAqB,EAArB,IAAsB,CAAC;SAAnC,IAAI,MAAI;SACT,EAAE,EAAE,MAAI,KAAK,aAAc,CAAC;aAAC,QAAQ,CAAC;SAEtC,IAAM,UAAU,GAAG,MAAM,CAAC,wBAAwB,CAAE,MAAM,EAAE,MAAI,CAAE,EAC5D,QAAQ,GAAK,6BAAqB,CAAE,MAAM,EAAE,MAAI,CAAE,CAAC;SAEzD,EAAE,EAAE,QAAS,CAAC,CAAC,CAAC;aACZ,IAAM,IAAI,GAAI,KAAK,CAAE,MAAI,CAAE,EACrB,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC;aAE7B,EAAE,EAAE,IAAI,IAAI,KAAM,CAAC,CAAC,CAAC;iBACjB,MAAM,CAAE,MAAI,CAAE,GAAG,OAAO,IAAI,KAAK,QAAQ;qBACrC,YAAY,CAAE,KAAK,EAAE,UAAU,CAAC,KAAK,EAAE,IAAI,CAAE,GAAE,CAC3C,IAAI,KAAK,OAAO;qBACZ,YAAY,CAAE,KAAK,EAAE,UAAU,CAAC,KAAK,CAAE;qBACvC,cAAc,CAAE,IAAI,CAAE,CAAE,KAAK,EAAE,UAAU,CAAC,KAAK,CAAE,CACxD,CAAC;aACV,CAAC;SACL,CAAC;SACD,IAAI,CAAC,CAAC;aACF,MAAM,CAAC,cAAc,CAAE,MAAM,EAAE,MAAI,EAAE,UAAU,CAAE,CAAC;SACtD,CAAC;MACJ;KAED,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;;;;;;;;;;;;;;AC1XD,KAAO,MAAM,uBAAY,CAAW,CAAC;AACrC,KAAO,KAAK,uBAAY,CAAU,CAAC,CAAC;AACpC,KAAO,UAAU,uBAAY,CAAe,CAAC,CAAC;AAC9C,wCAA2C,CAE3C,CAAC,CAFwD;AAehD,iBAAQ;AAbT,2BAAM,EAAE,sBAAM,EAAE,8BAAU,EAC1B,iBAAI,EAAE,iBAAI,EAAE,uBAAO,EAAE,iBAAI,EACzB,sCAAY,EAAE,8BAAQ,EAAE,8BAAQ,EAAE,8BAAQ,EAAE,8BAAQ,CAAgB;AAG5E,KAAM,aAAa,GAAG,KAAK,CAAC;AAE5B,KAAI,QAAQ,GAAG,CAAC,CAAC;AAEjB;KACI,MAAM,CAAC,GAAG,GAAG,QAAQ,EAAE,CAAC;AAC5B,EAAC;AAcD;KA2CI;SAjCA,YAAO,GAAmC,KAAK,CAAC,CAAC;SAGjD,eAAU,GAAe,KAAK,CAAC;SAG/B,iBAAY,GAAoB,KAAK,CAAC;SA4BlC,IAAI,CAAC,GAAG,GAAG,QAAQ,EAAE,CAAC;SACtB,IAAI,CAAC,UAAU,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;KAC7C,CAAC;KApBM,gBAAM,GAAb,UAAe,UAAiC,EAAG,WAAY;SAC3D,IAAM,IAAI,GAAyB,IAAI,CAAE,UAAU,IAAI,EAAE,EAAE,aAAa,CAAE,CAAC;SAE3E,EAAE,EAAE,UAAW,CAAC,EAAC;aACL,wCAAW,EAAE,sCAAY,CAAgB;aACjD,EAAE,EAAE,WAAW,IAAI,YAAa,CAAC,EAAC;iBAC9B,IAAM,SAAS,GAAG,IAAI,qBAAQ,CAAE,IAAI,CAAC,SAAS,CAAC,YAAY,CAAE,CAAC;iBAC9D,WAAW,IAAI,SAAS,CAAC,YAAY,CAAE,WAAW,CAAE,CAAC;iBACrD,YAAY,IAAI,SAAS,CAAC,KAAK,CAAE,YAAY,CAAE,CAAC;iBAChD,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;aAClC,CAAC;SACL,CAAC;SAED,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,EAAE,WAAW,CAAE,CAAC;KACjE,CAAC;KASD,8BAAU,GAAV,cAAqB,CAAC;KAKtB,sBAAE,GAAF,UAAG,IAAI,EAAE,QAAQ,EAAE,OAAO;SACtB,MAAM,CAAO,UAAU,CAAC,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;KAC3D,CAAC;KAOD,uBAAG,GAAH,UAAI,IAAc,EAAE,QAAoB,EAAE,OAAQ;SAC9C,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;SAC/B,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE,QAAQ,EACrC,IAAI,UAAU,CACV,OAAO,EACP,IAAI,CAAC,UAAU,CAAE,CACpB,CAAC;SAC1B,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAKD,iCAAa,GAAb,UAAe,GAAgB,EAAE,IAAc,EAAE,QAAoB;SACjE,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC;SACtC,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;SAE9B,IAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC;SAEhD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aAClC,IAAM,SAAS,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAItC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC;iBAAC,KAAK,CAAC;aAEtB,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;SAC5C,CAAC;SACD,EAAE,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;aAAC,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC,CAAC;SAErD,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAMD,4BAAQ,GAAR,UAAS,GAAe,EAAE,IAAI,EAAE,QAAS;SACrC,EAAE,EAAE,CAAC,GAAI,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;SAEvB,IAAM,EAAE,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,QAAQ,EAAE,CAAC,EACtC,WAAW,GAAG,IAAI,CAAC,YAAY,IAAI,CAAC,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,CAAC;SAElE,IAAI,SAAS,GAAG,WAAW,CAAC,EAAE,CAAC,CAAC;SAIhC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;aACb,IAAM,MAAM,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,QAAQ,EAAE,CAAC,CAAC;aACnD,SAAS,GAAG,WAAW,CAAC,EAAE,CAAC,GAAG,IAAI,WAAW,CAAE,GAAG,EAAE,EAAE,EAAE,MAAM,EAAE,WAAW,CAAE,CAAC;SAClF,CAAC;SAGD,UAAU,CAAE,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,SAAS,CAAE,CAAC;SACnD,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAOD,wBAAI,GAAJ,UAAK,IAAI,EAAE,QAAQ,EAAE,OAAO;SAExB,IAAM,MAAM,GAAG,SAAS,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAE,IAAI,CAAE,CAAC,CAAC;SAC7E,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,KAAK,CAAC,EAAE,OAAO,CAAC,CAAC;KAC5C,CAAC;KAGD,gCAAY,GAAZ,UAAa,GAAe,EAAE,IAAI,EAAE,QAAQ;SAExC,IAAM,MAAM,GAAG,SAAS,CAAC,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAE,IAAI,EAAE,GAAG,CAAE,CAAE,CAAC;SAC7F,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;KACtC,CAAC;KAOD,2BAAO,GAAP,UAAQ,IAAa,EAAE,CAAE,EAAE,CAAE,EAAE,CAAE;SAC7B,EAAE,EAAE,CAAC,IAAI,CAAC,OAAQ,CAAC;aAAC,MAAM,CAAC,IAAI,CAAC;SAEhC,MAAM,EAAE,SAAS,CAAC,MAAO,CAAC,EAAC;aAEvB,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;iBAAC,KAAK,CAAC;aACvC,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aAC1C,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aAC7C,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aAGhD;iBAEI,IAAM,OAAO,GAAG,KAAK,CAAE,SAAS,CAAC,MAAM,CAAE,CAAC;iBAE1C,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;qBACtC,OAAO,CAAE,CAAC,CAAE,GAAG,SAAS,CAAE,CAAC,CAAE,CAAC;iBAClC,CAAC;iBAGO,0BAAO,CAAU;iBACzB,IAAI,KAAK,GAAG,OAAO,CAAE,IAAI,CAAE,CAAC;iBAE5B,EAAE,EAAE,KAAM,CAAC;qBAAC,aAAa,CAAE,KAAK,EAAE,OAAO,CAAC,MAAM,CAAE,CAAC,EAAE,CAAC,CAAE,CAAE,CAAC;iBAC3D,EAAE,EAAE,KAAK,GAAG,OAAO,CAAC,GAAI,CAAC;qBAAC,aAAa,CAAE,KAAK,EAAE,OAAO,CAAE,CAAC;SAClE,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KAChB,CAAC;KAMD,2BAAO,GAAP;SACI,IAAI,CAAC,aAAa,EAAE,CAAC;SACrB,IAAI,CAAC,GAAG,EAAE,CAAC;KACf,CAAC;KArLL;SAAC,UAAU;kBAAA;KAsLX,gBAAC;AAAD,EAAC;AArLqB,kBAAS,YAqL9B;AAGD,KAAM,KAAK,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC;AAKvB,eAAM,GAA2B,IAAI,CAAE,SAAS,CAAC,SAAS,EAAE,aAAa,EAAE,YAAY,CAAE,CAAC;AAMvG,oBAAmB,QAAQ,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI;KACrD,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC;KACjB,EAAE,CAAC,CAAC,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC;SAEnC,EAAE,CAAC,CAAC,QAAQ,KAAK,KAAK,CAAC,IAAI,SAAS,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,CAAC,CAAC;aAAC,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC;SACjG,GAAG,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAG,CAAC,EAAE,EAAE,CAAC;aAC9C,MAAM,GAAG,SAAS,CAAC,QAAQ,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;SACzE,CAAC;KACL,CAAC;KAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,IAAI,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;SAE1C,GAAG,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aAC5D,MAAM,GAAG,QAAQ,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;SACxD,CAAC;KACL,CAAC;KAAC,IAAI,CAAC,CAAC;SAEJ,MAAM,GAAG,QAAQ,CAAC,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;KACpD,CAAC;KACD,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;AAAA,EAAC;AAGF;KAEI,qBAAoB,GAAG,EAAS,KAAK,EAAS,EAAE,EAAS,WAAW;SAAhD,QAAG,GAAH,GAAG;SAAS,UAAK,GAAL,KAAK;SAAS,OAAE,GAAF,EAAE;SAAS,gBAAW,GAAX,WAAW;SADpE,UAAK,GAAY,CAAC;KACqD,CAAC;KAC5E,kBAAC;AAAD,EAAC;AAcD,qBAAoB,GAAe,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAU;KACpE,GAAG,CAAC,OAAO,GAAG,SAAS,CAAC,KAAK,EAAE,GAAG,CAAC,OAAO,IAAI,EAAE,EAAE,IAAI,EAC9B,QAAQ,EAAE,IAAI,YAAY,CAAE,OAAO,EAAE,GAAG,EAAE,SAAS,CAAC,CAAC,CAAC;KAE9E,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;SACZ,IAAM,SAAS,GAAG,GAAG,CAAC,UAAU,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,EAAE,CAAC,CAAC;SAC1D,SAAS,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC;KACxC,CAAC;KAED,MAAM,CAAC,GAAG,CAAC;AACf,EAAC;AAAA,EAAC;AAIF,gBAAe,MAAsC,EAAE,IAAa,EAAE,QAAmB,EAAE,OAAO;KAC9F,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;SACX,IAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,EACvB,KAAK,GAAG,CAAE,OAAO,CAAC,KAAK,CAAE,QAAQ,CAAE,CAAE,CAAC;SAE5C,MAAM,CAAC,IAAI,CAAC,GAAG,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAE,KAAK,CAAE,GAAG,KAAK,CAAC;KAC/D,CAAC;KAED,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;AAAA,EAAC;AAGF;KACI,oBAAoB,OAAO,EAAS,SAAqB;SAArC,YAAO,GAAP,OAAO;SAAS,cAAS,GAAT,SAAS,CAAY;KAAG,CAAC;KACjE,iBAAC;AAAD,EAAC;AAID,iBAAgB,MAAsC,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAoB;KACxF,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC;SAAC,MAAM,CAAC;KAEpB,IAAI,CAAC,GAAG,CAAC,EAAE,SAAS,CAAC;KACrB,IAAM,OAAO,GAAG,OAAO,CAAC,OAAO,EAAE,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;KAG/D,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;SACjC,IAAM,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;SAC5B,GAAG,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aACzB,SAAS,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAC9B,OAAO,SAAS,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;aAC/B,OAAO,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;SAClD,CAAC;SACD,MAAM,CAAC,EAAE,CAAC;KACd,CAAC;KAED,IAAM,KAAK,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;KAC3C,GAAG,CAAC,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;SAC3B,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;SAChB,IAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;SAG9B,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;aAAC,KAAK,CAAC;SAGrB,IAAM,SAAS,GAAG,EAAE,CAAC;SACrB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;aACvC,IAAM,OAAO,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;aAC5B,EAAE,CAAC,CACC,QAAQ,IAAI,QAAQ,KAAK,OAAO,CAAC,QAAQ;iBACzC,QAAQ,KAAK,OAAO,CAAC,QAAQ,CAAC,SAAS;iBACvC,OAAO,IAAI,OAAO,KAAK,OAAO,CAAC,OACnC,CAAC,CAAC,CAAC;iBACC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;aAC5B,CAAC;aAAC,IAAI,CAAC,CAAC;iBACJ,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;iBAC9B,EAAE,CAAC,CAAC,SAAS,IAAI,EAAE,SAAS,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC;qBACvC,OAAO,SAAS,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;qBAC/B,OAAO,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;iBAClD,CAAC;aACL,CAAC;SACL,CAAC;SAGD,EAAE,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;aACnB,MAAM,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC;SAC7B,CAAC;SAAC,IAAI,CAAC,CAAC;aACJ,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;SACxB,CAAC;KACL,CAAC;KACD,MAAM,CAAC,MAAM,CAAC;AAClB,EAAC;AAAA,EAAC;AAKF,kBAAiB,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,KAAK;KACvC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;SACX,IAAM,OAAK,GAAyB,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;aACjD,KAAK,CAAC,IAAI,EAAE,OAAK,CAAC,CAAC;aACnB,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;SACpC,CAAC,CAAC,CAAC;SACH,OAAK,CAAC,SAAS,GAAG,QAAQ,CAAC;KAC/B,CAAC;KACD,MAAM,CAAC,GAAG,CAAC;AACf,EAAC;AAAA,EAAC;AAGF,wBAAwB,MAAkC,EAAE,CAAC;KACzD,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,EAAE,CAAC,CAAE,CAAC;MAAA;AACtC,EAAC;;;;;;;;ACrWY,sBAAa,GAAG,KAAK,CAAC;AAcnC;KACI,sBACW,OAAO,EACP,GAAG,EACH,SAAe,EACf,QAAoB;SAHpB,YAAO,GAAP,OAAO;SACP,QAAG,GAAH,GAAG;SACH,cAAS,GAAT,SAAS,CAAM;SACf,aAAQ,GAAR,QAAQ,CAAY;KAC7B,CAAC;KAEH,4BAAK,GAAL,UAAO,QAAQ;SACX,aAAmC,EAA3B,oBAAO,EAAE,wBAAS,CAAU;SACpC,EAAE,CAAC,CAAC,SAAS,CAAC;aAAC,SAAS,CAAC,KAAK,EAAE,CAAC;SACjC,MAAM,CAAC,IAAI,YAAY,CAAE,OAAO,EAAE,OAAO,IAAI,IAAI,CAAC,GAAG,EAAE,SAAS,EAAE,QAAQ,CAAE,CAAC;KACjF,CAAC;KACL,mBAAC;AAAD,EAAC;AAbY,qBAAY,eAaxB;AAuBD;KAGI,kBAAa,GAAkC;SAF/C,aAAQ,GAAuB,EAAE,CAAC;SAG9B,EAAE,EAAE,GAAI,CAAC,EAAC;aACN,EAAE,EAAE,GAAG,YAAY,QAAS,CAAC,EAAC;iBAC1B,IAAI,CAAC,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;aACzC,CAAC;aACD,IAAI,EAAC;iBACD,GAAG,IAAI,IAAI,CAAC,YAAY,CAAE,GAAG,CAAE,CAAC;aACpC,CAAC;SACL,CAAC;KACL,CAAC;KAED,wBAAK,GAAL,UAAO,GAAc;SACjB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAE,GAAG,CAAC,QAAQ,CAAE,CAAC;KACzD,CAAC;KAED,+BAAY,GAAZ,UAAc,GAAsB;SAChC,GAAG,EAAE,IAAI,KAAK,IAAI,GAAI,CAAC,EAAC;aACpB,IAAI,CAAC,QAAQ,CAAE,KAAK,EAAE,GAAG,CAAE,KAAK,CAAE,CAAE;SACxC,CAAC;KACL,CAAC;KAED,+BAAY,GAAZ,UAAc,KAAc;SACxB,GAAG,EAAc,UAA4B,EAA5B,UAAK,CAAC,KAAK,CAAE,qBAAa,CAAE,EAA5B,cAA4B,EAA5B,IAA6B,CAAC;aAA1C,IAAI,MAAI;aACT,IAAI,CAAC,QAAQ,CAAE,MAAI,EAAE,kBAAkB,CAAE,MAAI,CAAE,CAAE,CAAC;UACrD;KACL,CAAC;KAED,2BAAQ,GAAR,UAAU,KAAc,EAAE,QAAsC;SACpD,4BAAQ,CAAU;SAE1B,GAAG,EAAc,UAA4B,EAA5B,UAAK,CAAC,KAAK,CAAE,qBAAa,CAAE,EAA5B,cAA4B,EAA5B,IAA6B,CAAC;aAA1C,IAAI,MAAI;aACT,QAAQ,CAAC,IAAI,CAAE,IAAI,eAAe,CAAE,MAAI,EAAE,QAAQ,CAAE,CAAE,CAAC;UAC1D;KACL,CAAC;KAED,4BAAS,GAAT,UAAW,MAAW,EAAE,MAAoB;SACxC,IAAO,OAAO,GAAG,MAAM,CAAC,OAAO,IAAI,CAAE,MAAM,CAAC,OAAO,GAAG,EAAE,CAAE,CAAC;SAC3D,GAAG,EAAe,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAc,CAAC;aAA5B,IAAI,OAAK;aACV,GAAG,CAAE,OAAO,EAAE,OAAK,CAAC,IAAI,EAAE,OAAK,CAAC,QAAQ,EAAE,MAAM,CAAE,CAAC;UACtD;KACL,CAAC;KAED,8BAAW,GAAX,UAAa,MAAW,EAAE,MAAoB;SAClC,4BAAO,CAAY;SAC3B,EAAE,EAAE,OAAQ,CAAC,EAAC;aACV,GAAG,EAAe,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAc,CAAC;iBAA5B,IAAI,OAAK;iBACV,IAAI,CAAE,OAAO,EAAE,OAAK,CAAC,IAAI,EAAE,OAAK,CAAC,QAAQ,EAAE,MAAM,CAAE,CAAC;cACvD;SACL,CAAC;KACL,CAAC;KACL,eAAC;AAAD,EAAC;AArDY,iBAAQ,WAqDpB;AAED;KAGI,yBACW,IAAa,EACpB,QAAsC;SAD/B,SAAI,GAAJ,IAAI,CAAS;SAGpB,EAAE,EAAE,QAAQ,KAAK,IAAK,CAAC,EAAC;aACpB,IAAI,CAAC,QAAQ,GAAG,kBAAkB,CAAE,IAAI,CAAE,CAAC;SAC/C,CAAC;SACD,IAAI,CAAC,EAAE,EAAE,OAAO,QAAQ,KAAK,QAAS,CAAC,EAAC;aACpC,IAAI,CAAC,QAAQ;iBACT;qBACI,IAAM,OAAO,GAAG,IAAI,CAAE,QAAQ,CAAE,CAAC;qBACjC,OAAO,IAAI,OAAO,CAAC,KAAK,CAAE,IAAI,EAAE,SAAS,CAAE,CAAC;iBAChD,CAAC,CAAC;SACV,CAAC;SACD,IAAI,EAAC;aACD,IAAI,CAAC,QAAQ,GAAa,QAAQ,CAAC;SACvC,CAAC;KACL,CAAC;KACL,sBAAC;AAAD,EAAC;AAOD,aAAoB,IAAkB,EAAE,IAAa,EAAE,QAAmB,EAAE,OAAQ;KAChF,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,CAAE,IAAI,CAAC,OAAO,GAAG,EAAE,CAAE,CAAC;KACtD,GAAG,CAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAE,CAAC;AAC5C,EAAC;AAHe,WAAE,KAGjB;AAGD,cAAqB,IAAkB,EAAE,IAAa,EAAE,QAAmB,EAAE,OAAY;KAC7E,0BAAO,CAAU;KACzB,OAAO,IAAI,IAAI,CAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAE,CAAC;AACxD,EAAC;AAHe,YAAG,MAGlB;AAMD,mBAA0B,IAAkB,EAAE,IAAa;KAC/C,0BAAO,CAAU;KACzB,EAAE,EAAE,OAAQ,CAAC,EAAC;SACV,IAAM,KAAK,GAAG,OAAO,CAAE,IAAI,CAAE,EACvB,iBAAG,CAAa;SAEtB,EAAE,EAAE,KAAM,CAAC;aAAC,WAAW,CAAE,KAAK,CAAE,CAAC;SACjC,EAAE,EAAE,GAAI,CAAC;aAAC,WAAW,CAAE,GAAG,EAAE,IAAI,CAAE,CAAC;KACvC,CAAC;AACL,EAAC;AATe,iBAAQ,WASvB;AAAA,EAAC;AAGF,mBAA0B,IAAkB,EAAE,IAAa,EAAE,CAAO;KACxD,0BAAO,CAAU;KACzB,EAAE,EAAE,OAAQ,CAAC,EAAC;SACV,IAAM,KAAK,GAAG,OAAO,CAAE,IAAI,CAAE,EACvB,iBAAG,CAAa;SAEtB,EAAE,EAAE,KAAM,CAAC;aAAC,WAAW,CAAE,KAAK,EAAE,CAAC,CAAE,CAAC;SACpC,EAAE,EAAE,GAAI,CAAC;aAAC,WAAW,CAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAE,CAAC;KAC1C,CAAC;AACL,EAAC;AATe,iBAAQ,WASvB;AAAA,EAAC;AAGF,mBAA0B,IAAkB,EAAE,IAAa,EAAE,CAAC,EAAE,CAAC;KACrD,0BAAO,CAAU;KACzB,EAAE,EAAE,OAAQ,CAAC,EAAC;SACV,IAAM,KAAK,GAAG,OAAO,CAAE,IAAI,CAAE,EACvB,iBAAG,CAAa;SAEtB,EAAE,EAAE,KAAM,CAAC;aAAC,WAAW,CAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;SACvC,EAAE,EAAE,GAAI,CAAC;aAAC,WAAW,CAAE,GAAG,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;KAC7C,CAAC;AACL,EAAC;AATe,iBAAQ,WASvB;AAAA,EAAC;AAGF,mBAA0B,IAAkB,EAAE,IAAa,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;KACxD,0BAAO,CAAU;KACzB,EAAE,EAAE,OAAQ,CAAC,EAAC;SACV,IAAM,KAAK,GAAG,OAAO,CAAE,IAAI,CAAE,EACvB,iBAAG,CAAa;SAEtB,EAAE,EAAE,KAAM,CAAC;aAAC,WAAW,CAAE,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;SAC1C,EAAE,EAAE,GAAI,CAAC;aAAC,WAAW,CAAE,GAAG,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;KAChD,CAAC;AACL,EAAC;AATe,iBAAQ,WASvB;AAAA,EAAC;AAIF,sBAAsB,MAAuB;KACzC,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,CAAE,CAAC;MAAA;AACnC,EAAC;AAED,sBAAsB,MAAuB,EAAE,CAAC;KAC5C,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,EAAE,CAAC,CAAE,CAAC;MAAA;AACtC,EAAC;AAED,sBAAsB,MAAuB,EAAE,CAAC,EAAE,CAAC;KAC/C,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;MAAA;AACzC,EAAC;AAED,sBAAsB,MAAuB,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;KAClD,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;MAAA;AAC5C,EAAC;AAED,sBAAsB,MAAuB,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;KACrD,GAAG,EAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;SAAlB,IAAI,EAAE;SACP,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,EAAE,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;MAAA;AAC/C,EAAC;AAGD,cAAc,OAA4B,EAAE,IAAa,EAAE,QAAmB,EAAE,OAAgB,EAAE,GAAa;KAC3G,IAAM,MAAM,GAAG,OAAO,CAAE,IAAI,CAAE,EACxB,OAAO,GAAG,IAAI,YAAY,CAAE,OAAO,EAAE,GAAG,IAAI,OAAO,EAAE,IAAI,EAAE,QAAQ,CAAE,CAAC;KAE5E,EAAE,EAAE,MAAO,CAAC,EAAC;SACT,MAAM,CAAC,IAAI,CAAE,OAAO,CAAE,CAAC;KAC3B,CAAC;KACD,IAAI,EAAC;SACD,OAAO,CAAE,IAAI,CAAE,GAAG,CAAE,OAAO,CAAE,CAAC;KAClC,CAAC;AACL,EAAC;AAAA,EAAC;AAGF,eAAe,OAA4B,EAAE,IAAa,EAAE,QAAmB,EAAE,OAAY;KACzF,IAAM,MAAM,GAAG,OAAO,CAAE,IAAI,CAAE,CAAC;KAE/B,EAAE,EAAE,MAAO,CAAC,CAAC,CAAC;SACV,IAAM,MAAM,GAAG,EAAE,CAAC;SAElB,GAAG,CAAC,CAAY,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAO,CAAC;aAAlB,IAAI,EAAE;aACR,EAAE,EAAE,CAAE,QAAQ,IAAI,QAAQ,KAAK,EAAE,CAAC,QAAQ,CAAE,IAAI,OAAO,KAAK,EAAE,CAAC,OAAQ,CAAC,CAAC,CAAC;iBACtE,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;aACpB,CAAC;UACJ;SAED,OAAO,CAAE,IAAI,CAAE,GAAG,MAAM,CAAC,MAAM,GAAG,MAAM,GAAG,KAAK,CAAC,CAAC;KACtD,CAAC;AACL,EAAC;AAAA,EAAC;AAEF,KAAM,iBAAiB,GAAG,EAAE,CAAC;AAE7B,6BAA6B,KAAc;KACvC,MAAM,CAAC,iBAAiB,CAAE,KAAK,CAAE,IAAI,CACjC,iBAAiB,CAAE,KAAK,CAAE,GAAG,UAAU,CAAC,EAAE,CAAC,EAAE,CAAC;SAC1C,MAAM,EAAE,SAAS,CAAC,MAAO,CAAC,EAAC;aAEvB,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,KAAK,CAAE,CAAC;iBAAC,KAAK,CAAC;aACxC,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aAC3C,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aAC9C,KAAK,CAAC;iBAAG,QAAQ,CAAE,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAAC,KAAK,CAAC;aACjD;iBACI,IAAM,IAAI,GAAG,CAAE,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;iBAEhC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;qBACxC,IAAI,CAAC,IAAI,CAAE,SAAS,CAAE,CAAC,CAAE,CAAE,CAAC;iBAChC,CAAC;iBAED,IAAI,CAAC,OAAO,CAAC,KAAK,CAAE,IAAI,EAAE,IAAI,CAAE,CAAC;SACzC,CAAC;KACL,CAAC,CACJ,CAAC;AACN,EAAC","file":"./index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"tools\"] = factory();\n\telse\n\t\troot[\"tools\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c7b96d84065cb513ab8a\n **/","import * as tools from './tools'\r\nexport { tools }\r\nexport * from './mixins'\r\nexport * from './messenger'\r\nimport * as eventsApi from './events-api'\r\nexport { eventsApi }\r\n\r\nimport { Mixable, MixableConstructor } from './mixins'\r\n\r\ndeclare global {\r\n    interface ObjectConstructor {\r\n        /** Polyfill for Object.assign */\r\n        assign< T >( dest : T, ...sources : Object[] ) : T\r\n\r\n        /** Global logging interface, for console debugging. */\r\n        log : tools.Log\r\n\r\n        /** ES5 Object.extend */\r\n        extend( protoProps : {}, staticProps : {} ) : MixableConstructor< any >\r\n    }\r\n}\r\n\r\nObject.extend = ( protoProps, staticProps ) => Mixable.extend( protoProps, staticProps );\r\nObject.assign || ( Object.assign = tools.assign );\r\nObject.log = tools.log;\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.ts\n **/","/**\r\n * Simple overridable logging stubs, writing to `console` by default.\r\n * Node.js users might want to redirect logging somewhere.\r\n * \r\n * This is the singleton avaliable globally through `Object.log` or \r\n * exported [[log]] variable.\r\n */\r\nexport class Log {\r\n    /** Logging level.\r\n     * - *0* - turn off everything.\r\n     * - *1* - `log.error()` only;\r\n     * - *2* - (_default_) `log.error()` and `log.warn()`;\r\n     * - *3* - `error()`, `warn()`, and `info()`;\r\n     * - *4* - all of above + `debug()`.\r\n     */\r\n    level : number\r\n\r\n    /** Stop in debugger on specified logging events. \r\n     * \r\n     *      Object.log.stops.error = true;\r\n     */\r\n    stops : LogOptions = {}\r\n\r\n    /** Throw exceptions for specified logging events.\r\n     *  \r\n     *      Object.log.throws.error = true;\r\n     */\r\n    throws : LogOptions = {}\r\n\r\n    /** Logging events counter. Can be used for test assertions. */\r\n    counts : { error : number, warn : number, info : number, debug : number }\r\n\r\n    /** Overridable logger API. Defaults to `window.console` */\r\n    logger : Logger\r\n\r\n    private doLogging( type, args : any[] ){\r\n        const { logger } = this,\r\n              logMethod = logger && logger[ type ];\r\n\r\n        if( logMethod ) logMethod.apply( logger, args );\r\n\r\n        if( this.stops[ type ] )  debugger;\r\n        if( this.throws[ type ] ) throw new Error( `[${ type }] ${ args[ 0 ] }` );\r\n\r\n        this.counts[ type ]++;\r\n    }\r\n\r\n    /** Reset logger to default settings. */\r\n    reset() : this {\r\n        this.level = 2;\r\n        this.counts = { error : 0, warn : 0, info : 0, debug : 0 };\r\n        this.stops = {};\r\n        return this;\r\n    }\r\n\r\n    /** Show info, stop on errors.\r\n     * @param trueDeveloper Stop on warnings as well.\r\n     */\r\n    developer( trueDeveloper? : boolean ) : this {\r\n        this.level = 3;\r\n        this.stops = { error : true, warn : Boolean( trueDeveloper ) };\r\n        return this;\r\n    }\r\n\r\n    /** @hidden */\r\n    constructor(){\r\n        this.logger = typeof console !== 'undefined' ? console : null;\r\n        this.reset();\r\n    }\r\n\r\n    /** Similar to the `console.error`. Logging level 1. */\r\n    error( ...args : any[] ) : void {\r\n        if( this.level > 0 ) this.doLogging( 'error', args );\r\n    }\r\n\r\n    /** Similar to the `console.warn`. Logging level 2 (default). */\r\n    warn( ...args : any[] ) : void {\r\n        if( this.level > 1 ) this.doLogging( 'warn', args );\r\n    }\r\n\r\n    /** Similar to the `console.info`. Logging level 3. */\r\n    info( ...args : any[] ){\r\n        if( this.level > 2 ) this.doLogging( 'info', args );\r\n    }\r\n\r\n    /** Similar to the `console.debug`. Logging level 4. */\r\n    debug( ...args : any[] ){\r\n        if( this.level > 3 ) this.doLogging( 'debug', args );\r\n    }\r\n\r\n    /** `Object.log.state` - can be used to inspect logger state in the console. */\r\n    get state() : string {\r\n        return (`\r\nObject.log - Object+ Logging and Debugging Utility\r\n--------------------------------------------------\r\nObject.log.counts: Number of logged events by type\r\n    { errors : ${ this.counts.error }, warns : ${ this.counts.warn }, info : ${ this.counts.info }, debug : ${ this.counts.debug } }\r\n\r\nObject.log.level == ${ this.level } : Ignore events which are above specified level \r\n    - 0 - logging is off;\r\n    - 1 - Object.log.error(...) only;\r\n    - 2 - .error() and .warn();\r\n    - 3 - .error(), .warn(), and .info();\r\n    - 4 - all of above plus .debug().\r\n\r\nObject.log.stops: Stops in debugger for some certain event types\r\n     { error : ${ this.stops.error || false }, warn  : ${ this.stops.warn || false }, info  : ${ this.stops.info || false }, debug : ${ this.stops.debug || false } } \r\n\r\nObject.log.throws: Throws expection on some certain event types\r\n     { error : ${ this.throws.error || false }, warn  : ${ this.throws.warn || false }, info  : ${ this.throws.info || false }, debug : ${ this.throws.debug || false } }\r\n`);\r\n    }\r\n}\r\n\r\n/** Interface [[Log.logger]] must implement. */\r\nexport interface Logger {\r\n    error( ...args : any[] ) : void\r\n    warn( ...args : any[] ) : void\r\n    info( ...args : any[] ) : void\r\n    debug( ...args : any[] ) : void\r\n}\r\n\r\n/** Logger options used by [[Log.stop]] and [[Log.throws]]. */\r\nexport interface LogOptions {\r\n    error? : boolean\r\n    warn? : boolean\r\n    info? : boolean\r\n    debug? : boolean\r\n}\r\n\r\n/** Logger singleton.\r\n * @see [[Log]] for API.\r\n */\r\nexport let log = new Log();\r\n\r\n/** Check if value is raw JSON */\r\nexport function isValidJSON( value : any ) : boolean {\r\n    if( value === null ){\r\n        return true;\r\n    }\r\n\r\n    switch( typeof value ){\r\n    case 'number' :\r\n    case 'string' :\r\n    case 'boolean' :\r\n        return true;\r\n\r\n    case 'object':\r\n        var proto = Object.getPrototypeOf( value );\r\n\r\n        if( proto === Object.prototype || proto === Array.prototype ){\r\n            return every( value, isValidJSON );\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/** Get the base class constructor function.\r\n * @param Class Subclass constructor function.\r\n * @returns Base class constructor function.\r\n */\r\nexport function getBaseClass( Class : Function ) {\r\n    return Object.getPrototypeOf( Class.prototype ).constructor\r\n}\r\n\r\n/** Get a hash of static (constructor) properties which have not been inherited.\r\n * @param Ctor class constructor function.\r\n * @param names comma-separated list of static property names to compare.\r\n * @returns hash of listed statics which are added or overriden in the class.\r\n */\r\nexport function getChangedStatics( Ctor : Function, ...names : string[] ) : {}{\r\n    const Base = getBaseClass( Ctor ),\r\n          props = {};\r\n\r\n    for( let name of names ){\r\n        const value = Ctor[ name ];\r\n        if( value !== void 0 && value !== Base[ name ] ){\r\n            props[ name ] = value;\r\n        }\r\n    }\r\n\r\n    return props;\r\n}\r\n\r\n/** Checks whenever given object is an empty hash `{}` */\r\nexport function isEmpty( obj : {} ) : boolean {\r\n    if( obj ){\r\n        for( let key in obj ){\r\n            if( obj.hasOwnProperty( key ) ){\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\ntype Iteratee = ( value : any, key? : string | number ) => any;\r\n\r\n/** @hidden */\r\nfunction someArray( arr : any[], fun : Iteratee ) : any {\r\n    let result;\r\n\r\n    for( let i = 0; i < arr.length; i++ ){\r\n        if( result = fun( arr[ i ], i ) ){\r\n            return result;\r\n        }\r\n    }\r\n}\r\n\r\n/** @hidden */\r\nfunction someObject( obj : {}, fun : Iteratee ) : any {\r\n    let result;\r\n\r\n    for( let key in obj ){\r\n        if( obj.hasOwnProperty( key ) ){\r\n            if( result = fun( obj[ key ], key ) ){\r\n                return result;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/** Similar to underscore `_.some` */\r\nexport function some( obj, fun : Iteratee ) : any {\r\n    if( Object.getPrototypeOf( obj ) === ArrayProto ){\r\n        return someArray( obj, fun );\r\n    }\r\n    else{\r\n        return someObject( obj, fun );\r\n    }\r\n}\r\n\r\n/** Similar to underscore `_.every` */\r\nexport function every( obj : { }, predicate : Iteratee ) : boolean {\r\n    return !some( obj, x => !predicate( x ) );\r\n}\r\n\r\n/** Similar to `getOwnPropertyDescriptor`, but traverse the whole prototype chain. */\r\nexport function getPropertyDescriptor( obj : {}, prop : string ) : PropertyDescriptor {\r\n    let desc : PropertyDescriptor;\r\n\r\n    for( let proto = obj; !desc && proto; proto = Object.getPrototypeOf( proto ) ) {\r\n        desc = Object.getOwnPropertyDescriptor( obj, prop );\r\n    }\r\n\r\n    return desc;\r\n}\r\n\r\n/** Similar to underscore `_.omit` */\r\nexport function omit( source : {}, ...rest : string[] ) : {}\r\nexport function omit( source ) : {} {\r\n    const dest = {}, discard = {};\r\n\r\n    for( let i = 1; i < arguments.length; i ++ ){\r\n        discard[ arguments[ i ] ] = true;\r\n    }\r\n\r\n    for( var name in source ) {\r\n        if( !discard[ name ] && source.hasOwnProperty( name ) ) {\r\n            dest[ name ] = source[ name ];\r\n        }\r\n    }\r\n\r\n    return dest;\r\n}\r\n\r\n/** map `source` object properties with a given function, and assign the result to the `dest` object.\r\n * When `fun` returns `undefined`, skip this value. \r\n */\r\nexport function transform< A, B >( dest : { [ key : string ] : A }, source : { [ key : string ] : B }, fun : ( value : B, key : string ) => A | void ) : { [ key : string ] : A } {\r\n    for( var name in source ) {\r\n        if( source.hasOwnProperty( name ) ) {\r\n            var value = fun( source[ name ], name );\r\n            value === void 0 || ( dest[ name ] = < A >value );\r\n        }\r\n    }\r\n\r\n    return dest;\r\n}\r\n\r\n/** @hidden */\r\nexport function fastAssign< A, B >( dest : A, source : B ) : A & B {\r\n    for( var name in source ) {\r\n        dest[ name ] = source[ name ];\r\n    }\r\n\r\n    return <A & B >dest;\r\n}\r\n\r\n/** @hidden */\r\nexport function fastDefaults<A, B>( dest : A, source : B ) : A & B {\r\n    for( var name in source ) {\r\n        if( dest[ name ] === void 0 ){\r\n            dest[ name ] = source[ name ];\r\n        }\r\n    }\r\n\r\n    return <A & B >dest;\r\n}\r\n\r\n/** Similar to underscore `_.extend` and `Object.assign` */\r\nexport function assign< T >( dest : T, ...sources : Object[] ) : T\r\nexport function assign< T >( dest : T, source : Object ) : T {\r\n    for( var name in source ) {\r\n        if( source.hasOwnProperty( name ) ) {\r\n            dest[ name ] = source[ name ];\r\n        }\r\n    }\r\n\r\n    if( arguments.length > 2 ){\r\n        for( let i = 2; i < arguments.length; i++ ){\r\n            const other = arguments[ i ];\r\n            other && assign( dest, other );\r\n        }\r\n    }\r\n\r\n    return dest;\r\n}\r\n\r\n/** Similar to underscore `_.defaults` */\r\nexport function defaults< T >( dest : T, ...sources : Object[] ) : T\r\nexport function defaults< T >( dest : T, source : Object ) : T {\r\n    for( var name in source ) {\r\n        if( source.hasOwnProperty( name ) && dest[ name ] === void 0 ) {\r\n            dest[ name ] = source[ name ];\r\n        }\r\n    }\r\n\r\n    if( arguments.length > 2 ){\r\n        for( let i = 2; i < arguments.length; i++ ){\r\n            const other = arguments[ i ];\r\n            other && defaults( dest, other );\r\n        }\r\n    }\r\n\r\n    return dest;\r\n}\r\n\r\n/** Similar to underscore `_.keys` */\r\nexport function keys( o : any ) : string[]{\r\n    return o ? Object.keys( o ) : [];\r\n}\r\n\r\n/** Similar to underscore `_.once` */\r\nexport function once( func : Function ) : Function {\r\n    var memo, first = true;\r\n    return function() {\r\n        if ( first ) {\r\n            first = false;\r\n            memo = func.apply(this, arguments);\r\n            func = null;\r\n        }\r\n        return memo;\r\n    };\r\n}\r\n\r\nconst ArrayProto = Array.prototype,\r\n      DateProto = Date.prototype,\r\n      ObjectProto = Object.prototype;\r\n\r\n/**\r\n * Determine whenever two values are not equal, deeply traversing \r\n * arrays and plain JS objects (hashes). Dates are compared by enclosed timestamps, all other\r\n * values are compared with strict comparison.\r\n */\r\nexport function notEqual( a : any, b : any) : boolean {\r\n    if( a === b ) return false;\r\n\r\n    if( a && b && typeof a == 'object' && typeof b == 'object' ) {\r\n        const protoA = Object.getPrototypeOf( a );\r\n\r\n        if( protoA !== Object.getPrototypeOf( b ) ) return true;\r\n\r\n        switch( protoA ){\r\n            case DateProto   : return +a !== +b;\r\n            case ArrayProto  : return arraysNotEqual( a, b );\r\n            case ObjectProto :\r\n            case null:\r\n                return objectsNotEqual( a, b );\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/** @hidden */\r\nfunction objectsNotEqual( a, b ) {\r\n    const keysA = Object.keys( a );\r\n\r\n    if( keysA.length !== Object.keys( b ).length ) return true;\r\n\r\n    for( let i = 0; i < keysA.length; i++ ) {\r\n        const key = keysA[ i ];\r\n\r\n        if( !b.hasOwnProperty( key ) || notEqual( a[ key ], b[ key ] ) ) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n/** @hidden */\r\nfunction arraysNotEqual( a, b ) {\r\n    if( a.length !== b.length ) return true;\r\n\r\n    for( let i = 0; i < a.length; i++ ) {\r\n        if( notEqual( a[ i ], b[ i ] ) ) return true;\r\n    }\r\n\r\n    return false;\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/tools.ts\n **/","/**\r\n * Mixins and @define metaprogramming class extensions\r\n * \r\n * Vlad Balin & Volicon, (c) 2016\r\n */\r\nimport { log, assign, omit, getPropertyDescriptor, getBaseClass, defaults, transform } from './tools'\r\n\r\n/**\r\n * Class definition recognized by [[Mixable.define]]\r\n */\r\nexport interface ClassDefinition {\r\n    properties? : PropertyMap | boolean\r\n    mixins? : Mixin[]\r\n    mixinRules? : MixinRules\r\n    [ name : string ] : any\r\n}\r\n\r\ninterface PropertyMap {\r\n    [ name : string ] : Property\r\n}\r\n\r\ntype Property = PropertyDescriptor | ( () => any )\r\n\r\ntype Mixin = Constructor< any > | {}\r\n\r\n/**\r\n * Mixin property merge rules. Set with [[Mixable.mixinRules]] and [[mixinRules]] decorator.\r\n */\r\nexport interface MixinRules {\r\n    [ propertyName : string ] : MergeRule | MixinRules\r\n}\r\n\r\n/**\r\n * Property merge rule. Defines what will happen if the same member is defined in multiple mixins and the class.\r\n * - *merge* - assume property to be an object, which members taken from mixins must be merged.\r\n * - *pipe* - property is the function `( x : T ) => T` transforming the value. Multiple functions joined in pipe.\r\n * - *sequence* - property is the function. Multiple functions will be called in sequence.\r\n * - *reverse* - same as *sequence*, but functions called in reverse sequence.\r\n * - *every* - property is the function `( ...args : any[] ) => boolean`. Resulting method will return true if every single function returns true.\r\n * - *some* - same as previous, but method will return true when at least one function returns true.\r\n */\r\nexport type MergeRule = 'merge' | 'pipe' | 'sequence' | 'reverse' | 'every' | 'some'\r\n\r\n\r\ndeclare function __extends( a, b )\r\n\r\n/**\r\n *  Generic interface to reference constructor function type for any given T. \r\n */\r\nexport interface Constructor< T >{\r\n    new ( ...args : any[] ) : T\r\n}\r\n\r\n/**\r\n * Generic interface to reference constructor function of any Mixable type T.\r\n */\r\nexport interface MixableConstructor< T > extends Constructor< T >{\r\n    prototype : Mixable\r\n    create( a : any, b? : any ) : Mixable\r\n    mixins( ...mixins : ( Constructor<any> | {} )[] ) : MixableConstructor< T >\r\n    mixinRules( mixinRules : MixinRules ) : MixableConstructor< T >\r\n    mixTo( ...args : Constructor<any>[] ) : MixableConstructor< T >\r\n    define( definition : ClassDefinition, staticProps? : {} ) : MixableConstructor< T >\r\n    extend(spec? : ClassDefinition, statics? : {} ) : MixableConstructor< T >\r\n    predefine() : MixableConstructor< T >\r\n}\r\n\r\n/**\r\n * Base class, holding metaprogramming class extensions.\r\n * Supports mixins and Class.define metaprogramming method.\r\n * \r\n * It's required to use `@define` decorator on inheritace.\r\n * \r\n *      @define({ a : 1 }) // add 'a' property to A.prototype\r\n *      class A extends Mixable {}\r\n * \r\n * or\r\n *      @define\r\n *      class A extends Mixable {}\r\n */ \r\nexport class Mixable {\r\n    /** Generic class factory. May be overridden for abstract classes. Not inherited. */\r\n    static create( a : any, b? : any ) : Mixable {\r\n        return new (<any>this)( a, b );\r\n    }\r\n\r\n    /** @hidden */\r\n    protected static _mixinRules : MixinRules = { properties : 'merge' };\r\n\r\n    /** @hidden */\r\n    static _appliedMixins : any[]\r\n\r\n    /**\r\n     * Attach the sequence of mixins to the class prototype.\r\n     * \r\n     * ```javascript\r\n     *    MyMixableClass.mixins( plainObjMixin, OtherConstructor, ... );\r\n     *    MyOtherClass.mixins([ plainObjMixin, OtherConstructor, ... ]); \r\n     * ```\r\n     * \r\n     * @param mixins The list of class constructors or plain objects. Both static and prototype properties are mixed in for constructors.\r\n     */\r\n    static mixins( ...mixins : ( Mixin | Mixin[] )[] ) : typeof Mixable {\r\n        const proto      = this.prototype,\r\n              mergeRules : MixinRules = this._mixinRules || {},      \r\n              _appliedMixins = this._appliedMixins = ( this._appliedMixins || [] ).slice();\r\n\r\n        // Apply mixins in sequence...\r\n        for( let mixin of mixins ) {\r\n            // Mixins array should be flattened. \r\n            if( mixin instanceof Array ) {\r\n                return Mixable.mixins.apply( this, mixin );\r\n            }\r\n\r\n            // Don't apply mixins twice.\r\n            if( _appliedMixins.indexOf( mixin ) >= 0 ) continue;\r\n\r\n            _appliedMixins.push( mixin );\r\n\r\n            // For constructors, merge _both_ static and prototype members.\r\n            if( typeof mixin === 'function' ){\r\n                // Statics are merged by simple substitution.\r\n                defaults( this, mixin );\r\n\r\n                // Prototypes are merged according with a rules.\r\n                mergeProps( proto, (<Constructor<any>>mixin).prototype, mergeRules );\r\n            }\r\n            // Handle plain object mixins.\r\n            else {\r\n                mergeProps( proto, mixin, mergeRules );\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /** Inversion of control version of [[Mixable.mixin]].\r\n     * `Class.mixTo( A, B, ... )` will mix static and prototype `Class` members to the given list of classes.\r\n     * `Mixable.mixTo( A, B, ... )` can be used to convert any classes to mixable. \r\n    */\r\n    static mixTo< T >( ...args : Function[] ) : typeof Mixable {\r\n        for( let Ctor of args ) {\r\n            Mixable.mixins.call( Ctor, this );\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /** Define specific rules for mixin some particular class members.\r\n     *  mixinRules of the base class are properly merged on inheritance.\r\n     */\r\n    static mixinRules( mixinRules : MixinRules ) : MixableConstructor< Mixable > {\r\n        const Base = Object.getPrototypeOf( this.prototype ).constructor;\r\n\r\n        if( Base._mixinRules ) {\r\n            mergeProps( mixinRules, Base._mixinRules );\r\n        }\r\n\r\n        this._mixinRules = mixinRules;\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Main metaprogramming method. May be overriden in subclasses to customize the behavior.   \r\n     * - Merge definition to the class prototype.\r\n     * - Add native properties with descriptors from `definition.properties` to the prototype.\r\n     * - Prevents inheritance of 'create' factory method.\r\n     * - Assign mixinRules static property, and merge it with parent.\r\n     * - Adds mixins.\r\n     */\r\n    static define( definition : ClassDefinition = {}, staticProps? : {} ) : typeof Mixable {\r\n        // That actually might happen when we're using @define decorator... \r\n        if( !this.define ){\r\n            log.error( \"[Class.define] Class must have class extensions to use @define decorator. Use '@extendable' before @define, or extend the base class with class extensions.\", definition );\r\n            return this;\r\n        }\r\n\r\n        this.predefine();\r\n\r\n        // Obtain references to prototype and base class.\r\n        const proto = this.prototype;\r\n\r\n        // Extract prototype properties from the definition.\r\n        const protoProps = omit( definition, 'properties', 'mixins', 'mixinRules' ),\r\n            { properties = <PropertyMap> {}, mixins, mixinRules } = definition;\r\n\r\n        // Update prototype and statics.\r\n        assign( proto, protoProps );\r\n        assign( this, staticProps );\r\n\r\n        // Define native properties.\r\n        properties && Object.defineProperties( proto, transform( {}, <PropertyMap>properties, toPropertyDescriptor ) );\r\n\r\n        // Apply mixins and mixin rules.\r\n        mixinRules && this.mixinRules( mixinRules );\r\n        mixins && this.mixins( mixins );\r\n\r\n        return this;\r\n    }\r\n\r\n    /** Backbone-compatible extend method to be used in ES5 and for backward compatibility */\r\n    static extend(spec? : ClassDefinition, statics? : {} ) : typeof Mixable {\r\n        let Subclass : typeof Mixable;\r\n\r\n        // 1. Create the subclass (ES5 compatibility shim).\r\n        // If constructor function is given...\r\n        if( spec && spec.hasOwnProperty( 'constructor' ) ){\r\n            // ...we need to manually call internal TypeScript __extend function. Hack! Hack!\r\n            Subclass = <any>spec.constructor; \r\n            __extends( Subclass, this );\r\n        }\r\n        // Otherwise, create the subclall in usual way.\r\n        else{\r\n            Subclass = class Subclass extends this {};\r\n        }\r\n\r\n        // 2. Apply definitions\r\n        return spec ? Subclass.define( spec, statics ) : Subclass.predefine();\r\n    }\r\n\r\n    /** Do the magic necessary for forward declarations.\r\n     *  Can be overriden by subclasses.\r\n     *  Must be written in the way that it's safe to call twice.\r\n     */\r\n    static predefine() : typeof Mixable {\r\n        const BaseClass : typeof Mixable = getBaseClass( this );\r\n\r\n        // Make sure we don't inherit class factories.\r\n        if( BaseClass.create === this.create ) {\r\n            this.create = Mixable.create;\r\n        }\r\n\r\n        this.__super__ = BaseClass.prototype;\r\n\r\n        return this;\r\n    }\r\n\r\n    /** @hidden */\r\n    static __super__ : {}\r\n}\r\n\r\n/** @hidden */\r\nfunction toPropertyDescriptor( x : Property ) : PropertyDescriptor {\r\n    if( x ){\r\n        return typeof x === 'function' ? { get : < () => any >x } : <PropertyDescriptor> x;\r\n    }\r\n}\r\n\r\n/** @decorator `@mixinRules({ ... })`. Has the same effect as [[Mixable.mixinRules]]. Can be used with any ES6 class.\r\n *  See [[MixinRules]] for rules specification.\r\n */\r\nexport function mixinRules( rules : MixinRules ) {\r\n    return createDecorator( 'mixinRules', rules );\r\n}\r\n\r\n/** @decorator `@mixins( A, B, C... )`. \r\n * Has the same effect as [[Mixable.mixins]]. Can be used with any ES6 class.\r\n */ \r\nexport function mixins( ...list : {}[] ) {\r\n    return createDecorator( 'mixins', list );\r\n}\r\n\r\n/** @decorator `@extendable`. Convert ES6 class to be [[Mixable]] one. */\r\nexport function extendable( Type : Function ) : void {\r\n    Mixable.mixTo( Type );\r\n}\r\n\r\n/** @decorator `@predefine` for forward definitions. Can be used with [[Mixable]] classes only.\r\n * Forwards the call to the [[Mixable.predefine]]; \r\n */ \r\nexport function predefine( Constructor : MixableConstructor< any > ) : void {\r\n    Constructor.predefine();\r\n}\r\n\r\n/** @decorator `@define` for metaprogramming magic. Can be used with [[Mixable]] classes only.\r\n *  Forwards the call to [[Mixable.define]]. \r\n */\r\nexport function define( spec : ClassDefinition | MixableConstructor< any > ){\r\n    // Handle the case when `@define` used without arguments. \r\n    if( typeof spec === 'function' ){\r\n        ( <MixableConstructor< any >> spec).define({});\r\n    }\r\n    // Normal usage.\r\n    else{\r\n        return createDecorator( 'define', spec );\r\n    }\r\n} \r\n\r\n// Create ES7 class decorator forwarding call to the static class member.\r\n// If there is no such a member, forward the call to Class.\r\n/** @hidden */\r\nfunction createDecorator( name : string, spec : {} ){\r\n    return function( Ctor : Function ) : void {\r\n        if( Ctor[ name ] ) {\r\n            Ctor[ name ]( spec );\r\n        }\r\n        else {\r\n            Mixable[ name ].call( Ctor, spec );\r\n        }\r\n    }\r\n}\r\n\r\n/***********************\r\n * Mixins helpers\r\n */\r\n/** @hidden */\r\nfunction mergeObjects( a : {}, b : {}, rules? : MixinRules ) : {} {\r\n    const x = assign( {}, a );\r\n    return mergeProps( x , b, rules );\r\n}\r\n\r\n/** @hidden */\r\ninterface IMergeFunctions {\r\n    [ name : string ] : ( a : Function, b : Function ) => Function\r\n}\r\n\r\n/** @hidden */\r\nconst mergeFunctions : IMergeFunctions = {\r\n    pipe< A, B, C >( a: ( x : B ) => C, b : ( x : A ) => B ) : ( x : A ) => C {\r\n        return function( x : A ) : C {\r\n            return a.call( this, b.call( this, x ) );\r\n        }\r\n    },\r\n\r\n    sequence( a : Function, b : Function ){\r\n        return function() : void {\r\n            a.apply( this, arguments );\r\n            b.apply( this, arguments );\r\n        }\r\n    },\r\n\r\n    reverse( a : Function, b : Function ){\r\n        return function() : void {\r\n            b.apply( this, arguments );\r\n            a.apply( this, arguments );\r\n        }\r\n    },\r\n\r\n    every( a : Function, b : Function ){\r\n        return function() {\r\n            return a.apply( this, arguments ) && b.apply( this, arguments );\r\n        }\r\n    },\r\n\r\n    some( a : Function, b : Function ){\r\n        return function() {\r\n            return a.apply( this, arguments ) || b.apply( this, arguments );\r\n        }\r\n    }\r\n};\r\n\r\n/** @hidden */\r\nfunction mergeProps< T extends {} >( target : T, source : {}, rules : MixinRules = {}) : T {\r\n    for( let name of Object.keys( source ) ) {\r\n        if( name === 'constructor' ) continue;\r\n        \r\n        const sourceProp = Object.getOwnPropertyDescriptor( source, name ),\r\n              destProp   = getPropertyDescriptor( target, name ); // Shouldn't be own\r\n\r\n        if( destProp ) {\r\n            const rule  = rules[ name ],\r\n                  value = destProp.value;\r\n\r\n            if( rule && value ) {\r\n                target[ name ] = typeof rule === 'object' ?\r\n                    mergeObjects( value, sourceProp.value, rule ) :(\r\n                        rule === 'merge' ?\r\n                            mergeObjects( value, sourceProp.value ) :\r\n                            mergeFunctions[ rule ]( value, sourceProp.value )\r\n                    );\r\n            }\r\n        }\r\n        else {\r\n            Object.defineProperty( target, name, sourceProp );\r\n        }\r\n    }\r\n\r\n    return target;\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/mixins.ts\n **/","import Mixins = require( './mixins' )\r\nimport tools = require( './tools' );\r\nimport _eventsApi = require( './events-api' );\r\nimport { EventMap, EventsDefinition } from './events-api'\r\n\r\nconst { mixins, define, extendable } = Mixins,\r\n      { omit, once, isEmpty, keys } = tools,\r\n      { EventHandler, trigger0, trigger1, trigger2, trigger3 } = _eventsApi;\r\n\r\n// Regular expression used to split event strings.\r\nconst eventSplitter = /\\s+/;\r\n\r\nlet _idCount = 0;\r\n\r\nfunction uniqueId() : string {\r\n    return 'l' + _idCount++;\r\n}\r\n\r\nexport { EventMap, EventsDefinition }\r\n\r\nexport interface MessengerDefinition extends Mixins.ClassDefinition {\r\n    _localEvents? : EventMap\r\n    localEvents? : EventsDefinition\r\n}\r\n\r\n/*************************\r\n * Messenger is mixable class with capabilities of sending and receiving synchronous events.\r\n * This class itself can serve as both mixin and base class.\r\n */\r\n@extendable\r\nexport abstract class Messenger implements Mixins.Mixable {\r\n    // Define extendable mixin static properties.\r\n    static create : ( a : any, b? : any, c? : any ) => Messenger\r\n    static mixins : ( ...mixins : ( Mixins.Constructor<any> | {} )[] ) => Mixins.MixableConstructor< Messenger >\r\n    static mixinRules : ( mixinRules : Mixins.MixinRules ) => Mixins.MixableConstructor< Messenger >\r\n    static mixTo : ( ...args : Mixins.Constructor<any>[] ) => Mixins.MixableConstructor< Messenger >\r\n    static extend : (spec? : MessengerDefinition, statics? : {} ) => Mixins.MixableConstructor< Messenger >\r\n    static predefine : () => Mixins.MixableConstructor< Messenger >\r\n\r\n    /** @hidden */ \r\n    _events : _eventsApi.EventsSubscription = void 0;\r\n\r\n    /** @hidden */ \r\n    _listeners : Listeners = void 0\r\n\r\n    /** @hidden */ \r\n    _listeningTo : ListeningToMap = void 0\r\n\r\n    /** Unique client-only id. */\r\n    cid : string\r\n\r\n    // Prototype-only property to manage automatic local events subscription.\r\n    /** @hidden */ \r\n    _localEvents : _eventsApi.EventMap\r\n\r\n    /** @private */\r\n    static define( protoProps? : MessengerDefinition , staticProps? ) : typeof Messenger {\r\n        const spec : MessengerDefinition = omit( protoProps || {}, 'localEvents' );\r\n\r\n        if( protoProps ){\r\n            const { localEvents, _localEvents } = protoProps;\r\n            if( localEvents || _localEvents ){\r\n                const eventsMap = new EventMap( this.prototype._localEvents );\r\n                localEvents && eventsMap.addEventsMap( localEvents );\r\n                _localEvents && eventsMap.merge( _localEvents );\r\n                spec._localEvents = eventsMap;\r\n            }\r\n        }\r\n\r\n        return Mixins.Mixable.define.call( this, spec, staticProps );\r\n    }\r\n\r\n    /** @hidden */ \r\n    constructor(){\r\n        this.cid = uniqueId();\r\n        this.initialize.apply( this, arguments );\r\n    }\r\n\r\n    /** Method is called at the end of the constructor */\r\n    initialize() : void {}\r\n    \r\n    /** Bind an event to a `callback` function. Passing `\"all\"` will bind\r\n     *  the callback to all events fired.\r\n     */\r\n    on(name, callback, context) : this  {\r\n        return <this>internalOn(this, name, callback, context);\r\n    }\r\n\r\n    /** Remove one or many callbacks. If `context` is null, removes all\r\n     * callbacks with that function. If `callback` is null, removes all\r\n     * callbacks for the event. If `name` is null, removes all bound\r\n     * callbacks for all events.\r\n     */\r\n    off(name? : string, callback? : Function, context? )  : this {\r\n        if (!this._events) return this;\r\n        this._events = eventsApi(offApi, this._events, name, callback,\r\n                                new OffOptions(\r\n                                    context,\r\n                                    this._listeners )\r\n                                );\r\n        return this;\r\n    }\r\n\r\n    /** Tell this object to stop listening to either specific events ... or\r\n     * to every object it's currently listening to.\r\n     */ \r\n    stopListening( obj? : Messenger, name? : string, callback? : Function ) : this {\r\n        const listeningTo = this._listeningTo;\r\n        if (!listeningTo) return this;\r\n\r\n        const ids = obj ? [obj.cid] : keys(listeningTo);\r\n\r\n        for (let i = 0; i < ids.length; i++) {\r\n            const listening = listeningTo[ids[i]];\r\n\r\n            // If listening doesn't exist, this object is not currently\r\n            // listening to obj. Break out early.\r\n            if (!listening) break;\r\n\r\n            listening.obj.off(name, callback, this);\r\n        }\r\n        if (isEmpty(listeningTo)) this._listeningTo = void 0;\r\n\r\n        return this;\r\n    }\r\n\r\n    /** Inversion-of-control versions of `on`. Tell *this* object to listen to\r\n     * an event in another object... keeping track of what it's listening to\r\n     * for easier unbinding later.\r\n     */ \r\n    listenTo(obj : Messenger, name, callback? ) : this {\r\n        if( !obj ) return this;\r\n        \r\n        const id = obj.cid || (obj.cid = uniqueId()),\r\n              listeningTo = this._listeningTo || (this._listeningTo = {});\r\n\r\n        let listening = listeningTo[id];\r\n\r\n        // This object is not listening to any other events on `obj` yet.\r\n        // Setup the necessary references to track the listening callbacks.\r\n        if (!listening) {\r\n            const thisId = this.cid || (this.cid = uniqueId());\r\n            listening = listeningTo[id] = new ListeningTo( obj, id, thisId, listeningTo );\r\n        }\r\n\r\n        // Bind callbacks on obj, and keep track of them on listening.\r\n        internalOn( obj, name, callback, this, listening );\r\n        return this;\r\n    }\r\n\r\n    /** Bind an event to only be triggered a single time. After the first time\r\n     * the callback is invoked, its listener will be removed. If multiple events\r\n     * are passed in using the space-separated syntax, the handler will fire\r\n     * once for each event, not once for a combination of all events.\r\n     */ \r\n    once(name, callback, context)  : this {\r\n        // Map the event into a `{event: once}` object.\r\n        const events = eventsApi(onceMap, {}, name, callback, this.off.bind( this ));\r\n        return this.on(events, void 0, context);\r\n    }\r\n\r\n    /** Inversion-of-control versions of `once`.*/\r\n    listenToOnce(obj : Messenger, name, callback)  : this {\r\n        // Map the event into a `{event: once}` object.\r\n        const events = eventsApi(onceMap, {}, name, callback, this.stopListening.bind( this, obj ) );\r\n        return this.listenTo(obj, events);\r\n    }\r\n\r\n    /** Trigger one or many events, firing all bound callbacks. Callbacks are\r\n     * passed the same arguments as `trigger` is, apart from the event name\r\n     * (unless you're listening on `\"all\"`, which will cause your callback to\r\n     * receive the true name of the event as the first argument).\r\n     */ \r\n    trigger(name : string, a?, b?, c? ) : this {\r\n        if( !this._events ) return this;\r\n\r\n        switch( arguments.length ){\r\n            // Forward call to monomorphic fast-path functions.\r\n            case 1 : trigger0( this, name ); break;\r\n            case 2 : trigger1( this, name, a ); break;\r\n            case 3 : trigger2( this, name, a, b ); break;\r\n            case 4 : trigger3( this, name, a, b, c ); break;\r\n            \r\n            // Trigger event with more than 3 arguments.\r\n            default :\r\n                // Passing arguments around killing performance. Convert it to array.\r\n                const allArgs = Array( arguments.length );\r\n                \r\n                for( let i = 0; i < allArgs.length; i++ ){\r\n                    allArgs[ i ] = arguments[ i ];\r\n                }\r\n\r\n                // Send events.\r\n                const { _events } = this;\r\n                let queue = _events[ name ];\r\n\r\n                if( queue ) _fireEventAll( queue, allArgs.splice( 0, 1 ) );\r\n                if( queue = _events.all ) _fireEventAll( queue, allArgs );                      \r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Destructor. Stops messenger from listening to all objects,\r\n     * and stop others from listening to the messenger. \r\n     */\r\n    dispose() : void {\r\n        this.stopListening();\r\n        this.off();\r\n    }\r\n}\r\n\r\n/** @hidden */\r\nconst slice = Array.prototype.slice;\r\n\r\n/**\r\n * Backbone 1.2 API conformant Events mixin.\r\n */\r\nexport const Events : Messenger = <Messenger> omit( Messenger.prototype, 'constructor', 'initialize' );\r\n\r\n// Iterates over the standard `event, callback` (as well as the fancy multiple\r\n// space-separated events `\"change blur\", callback` and jQuery-style event\r\n// maps `{event: callback}`).\r\n/** @hidden */\r\nfunction eventsApi(iteratee, events, name, callback, opts) {\r\n    let i = 0, names;\r\n    if (name && typeof name === 'object') {\r\n        // Handle event maps.\r\n        if (callback !== void 0 && 'context' in opts && opts.context === void 0) opts.context = callback;\r\n        for (names = keys(name); i < names.length ; i++) {\r\n            events = eventsApi(iteratee, events, names[i], name[names[i]], opts);\r\n        }\r\n    } else if (name && eventSplitter.test(name)) {\r\n        // Handle space separated event names by delegating them individually.\r\n        for (names = name.split(eventSplitter); i < names.length; i++) {\r\n            events = iteratee(events, names[i], callback, opts);\r\n        }\r\n    } else {\r\n        // Finally, standard events.\r\n        events = iteratee(events, name, callback, opts);\r\n    }\r\n    return events;\r\n};\r\n\r\n/** @hidden */\r\nclass ListeningTo {\r\n    count : number = 0\r\n    constructor( public obj, public objId, public id, public listeningTo ){}\r\n}\r\n\r\n/** @hidden */\r\nexport interface ListeningToMap {\r\n    [ id : string ] : ListeningTo\r\n}\r\n\r\n/** @hidden */\r\nexport interface Listeners {\r\n    [ id : string ] : Messenger\r\n}\r\n\r\n// Guard the `listening` argument from the public API.\r\n/** @hidden */\r\nfunction internalOn(obj : Messenger, name, callback, context, listening? ) : Messenger {\r\n    obj._events = eventsApi(onApi, obj._events || {}, name,\r\n                            callback, new EventHandler( context, obj, listening));\r\n\r\n    if (listening) {\r\n        const listeners = obj._listeners || (obj._listeners = {});\r\n        listeners[listening.id] = listening;\r\n    }\r\n\r\n    return obj;\r\n};\r\n\r\n// The reducing API that adds a callback to the `events` object.\r\n/** @hidden */\r\nfunction onApi(events : _eventsApi.EventsSubscription, name : string, callback : Function, options) : _eventsApi.EventsSubscription {\r\n    if (callback) {\r\n        const handlers = events[name],\r\n              toAdd = [ options.clone( callback ) ];\r\n            \r\n        events[name] = handlers ? handlers.concat( toAdd ) : toAdd;\r\n    }\r\n    \r\n    return events;\r\n};\r\n\r\n/** @hidden */\r\nclass OffOptions {\r\n    constructor( public context, public listeners : Listeners ){}\r\n}\r\n\r\n// The reducing API that removes a callback from the `events` object.\r\n/** @hidden */\r\nfunction offApi(events : _eventsApi.EventsSubscription, name, callback, options : OffOptions ) {\r\n    if (!events) return;\r\n\r\n    let i = 0, listening;\r\n    const context = options.context, listeners = options.listeners;\r\n\r\n    // Delete all events listeners and \"drop\" events.\r\n    if (!name && !callback && !context) {\r\n        const ids = keys(listeners);\r\n        for (; i < ids.length; i++) {\r\n            listening = listeners[ids[i]];\r\n            delete listeners[listening.id];\r\n            delete listening.listeningTo[listening.objId];\r\n        }\r\n        return {};\r\n    }\r\n\r\n    const names = name ? [name] : keys(events);\r\n    for (; i < names.length; i++) {\r\n        name = names[i];\r\n        const handlers = events[name];\r\n\r\n        // Bail out if there are no events stored.\r\n        if (!handlers) break;\r\n\r\n        // Replace events if there are any remaining.  Otherwise, clean up.\r\n        const remaining = [];\r\n        for (let j = 0; j < handlers.length; j++) {\r\n            const handler = handlers[j];\r\n            if (\r\n                callback && callback !== handler.callback &&\r\n                callback !== handler.callback._callback ||\r\n                context && context !== handler.context\r\n            ) {\r\n                remaining.push(handler);\r\n            } else {\r\n                listening = handler.listening;\r\n                if (listening && --listening.count === 0) {\r\n                    delete listeners[listening.id];\r\n                    delete listening.listeningTo[listening.objId];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update tail event if the list has any events.  Otherwise, clean up.\r\n        if (remaining.length) {\r\n            events[name] = remaining;\r\n        } else {\r\n            delete events[name];\r\n        }\r\n    }\r\n    return events;\r\n};\r\n\r\n// Reduces the event callbacks into a map of `{event: onceWrapper}`.\r\n// `offer` unbinds the `onceWrapper` after it has been called.\r\n/** @hidden */\r\nfunction onceMap(map, name, callback, offer) {\r\n    if (callback) {\r\n        const _once : _eventsApi.Callback = map[name] = once(function() {\r\n            offer(name, _once);\r\n            callback.apply(this, arguments);\r\n        });\r\n        _once._callback = callback;\r\n    }\r\n    return map;\r\n};\r\n\r\n/** @hidden */\r\nfunction _fireEventAll( events : _eventsApi.EventHandler[], a ) : void {\r\n    for( let ev of events )\r\n        ev.callback.call( ev.ctx, a );\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/messenger.ts\n **/","/**************************************************************\r\n * Low-level high-performance publish-subscrive events API.\r\n * Monomorphic, minimalistic, JIT optimized.\r\n * \r\n * Implementation is 100% structurally compatible woth a subset of Backbone 1.2 Events.\r\n * \r\n * Type-R solely depends on that API for managing events subscriptions.\r\n */\r\n\r\n/** @private */\r\nexport const eventSplitter = /\\s+/;\r\n\r\n/** @private Main interface object must conform to in order to send events */\r\nexport interface EventSource {\r\n    _events : EventsSubscription\r\n}\r\n\r\n/** @private Internal hash holding events subscription */\r\nexport interface EventsSubscription {\r\n    all? : EventHandler[]\r\n    [ eventName : string ] : EventHandler[]\r\n}\r\n\r\n/** @private Event handler data structure, with a shape expected by Backbone 1.2 Events */\r\nexport class EventHandler {\r\n    constructor(\r\n        public context,\r\n        public ctx,\r\n        public listening : any,\r\n        public callback? : Callback\r\n    ){}\r\n\r\n    clone( callback ){\r\n        const { context, listening } = this;\r\n        if (listening) listening.count++;\r\n        return new EventHandler( context, context || this.ctx, listening, callback );\r\n    }\r\n}\r\n\r\n/** @private Callback structure, with a shape expected by Backbone 1.2 Events */\r\nexport interface Callback extends Function{\r\n    _callback? : any\r\n}\r\n\r\n/*******************\r\n * Prebuilt events map, used for optimized bulk event subscriptions.\r\n * \r\n * const events = new EventMap({\r\n *      'change' : true, // Resend this event from self as it is.\r\n *      'change:attr' : 'localTargetFunction',\r\n *      'executedInTargetContext' : function(){ ... }\r\n *      'executedInNativeContext' : '^props.handler' \r\n * })\r\n */\r\n/** @private */\r\nexport interface EventsDefinition {\r\n    [ events : string ] : Function | string | boolean\r\n}\r\n\r\n/** @private */\r\nexport class EventMap {\r\n    handlers : EventDescriptor[] = [];\r\n\r\n    constructor( map? : EventsDefinition | EventMap ){\r\n        if( map ){\r\n            if( map instanceof EventMap ){\r\n                this.handlers = map.handlers.slice();\r\n            }\r\n            else{\r\n                map && this.addEventsMap( map );\r\n            }\r\n        }\r\n    }\r\n\r\n    merge( map : EventMap ){\r\n        this.handlers = this.handlers.concat( map.handlers );\r\n    }\r\n\r\n    addEventsMap( map : EventsDefinition ){\r\n        for( let names in map ){\r\n            this.addEvent( names, map[ names ] )\r\n        }\r\n    }\r\n\r\n    bubbleEvents( names : string ){\r\n        for( let name of names.split( eventSplitter ) ){\r\n            this.addEvent( name, getBubblingHandler( name ) );\r\n        }\r\n    }\r\n\r\n    addEvent( names : string, callback : Function | string | boolean ){\r\n        const { handlers } = this;   \r\n        \r\n        for( let name of names.split( eventSplitter ) ){\r\n            handlers.push( new EventDescriptor( name, callback ) );\r\n        }        \r\n    }\r\n\r\n    subscribe( target : {}, source : EventSource ){\r\n        const  _events = source._events || ( source._events = {} );\r\n        for( let event of this.handlers ){\r\n            _on( _events, event.name, event.callback, target );\r\n        }\r\n    }\r\n\r\n    unsubscribe( target : {}, source : EventSource ){\r\n        const { _events } = source;\r\n        if( _events ){\r\n            for( let event of this.handlers ){\r\n                _off( _events, event.name, event.callback, target );\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nclass EventDescriptor {\r\n    callback : Function\r\n\r\n    constructor(\r\n        public name : string,\r\n        callback : Function | string | boolean\r\n    ){\r\n        if( callback === true ){\r\n            this.callback = getBubblingHandler( name );\r\n        }\r\n        else if( typeof callback === 'string' ){\r\n            this.callback = \r\n                function localCallback(){\r\n                    const handler = this[ callback ]; \r\n                    handler && handler.apply( this, arguments );\r\n                };\r\n        }\r\n        else{\r\n            this.callback = <Function>callback;\r\n        }\r\n    }\r\n}\r\n\r\n/****************************\r\n * Subscription API \r\n */\r\n\r\n/** @private */\r\nexport function on( self : EventSource, name : string, callback : Function, context? ){\r\n    const _events = self._events || ( self._events = {} );\r\n    _on( _events, name, callback, context );\r\n}\r\n\r\n/** @private */\r\nexport function off( self : EventSource, name : string, callback : Function, context : {} ){\r\n    const { _events } = self;\r\n    _events && _off( _events, name, callback, context );\r\n}\r\n\r\n/*********************************\r\n * Event-triggering API \r\n */\r\n/** @private */\r\nexport function trigger0( self : EventSource, name : string ) : void {\r\n    const { _events } = self;\r\n    if( _events ){\r\n        const queue = _events[ name ],\r\n            { all } = _events;\r\n\r\n        if( queue ) _fireEvent0( queue );\r\n        if( all ) _fireEvent1( all, name );\r\n    }\r\n};\r\n\r\n/** @private */\r\nexport function trigger1( self : EventSource, name : string, a : any ) : void {\r\n    const { _events } = self;\r\n    if( _events ){\r\n        const queue = _events[ name ],\r\n            { all } = _events;\r\n\r\n        if( queue ) _fireEvent1( queue, a );\r\n        if( all ) _fireEvent2( all, name, a );\r\n    }\r\n};\r\n\r\n/** @private */\r\nexport function trigger2( self : EventSource, name : string, a, b ) : void {\r\n    const { _events } = self;\r\n    if( _events ){\r\n        const queue = _events[ name ],\r\n            { all } = _events;\r\n\r\n        if( queue ) _fireEvent2( queue, a, b );\r\n        if( all ) _fireEvent3( all, name, a, b );\r\n    }\r\n};\r\n\r\n/** @private */\r\nexport function trigger3( self : EventSource, name : string, a, b, c ) : void{\r\n    const { _events } = self;\r\n    if( _events ){\r\n        const queue = _events[ name ],\r\n            { all } = _events;\r\n\r\n        if( queue ) _fireEvent3( queue, a, b, c );\r\n        if( all ) _fireEvent4( all, name, a, b, c );\r\n    }\r\n};\r\n\r\n// Specialized functions with events triggering loops.\r\n// JS JIT loves these small functions and code duplication.\r\nfunction _fireEvent0( events : EventHandler[] ) : void {\r\n    for( let ev of events )\r\n        ev.callback.call( ev.ctx );\r\n}\r\n\r\nfunction _fireEvent1( events : EventHandler[], a ) : void {\r\n    for( let ev of events )\r\n        ev.callback.call( ev.ctx, a );\r\n}\r\n\r\nfunction _fireEvent2( events : EventHandler[], a, b ) : void {\r\n    for( let ev of events )\r\n        ev.callback.call( ev.ctx, a, b );\r\n}\r\n\r\nfunction _fireEvent3( events : EventHandler[], a, b, c ) : void {\r\n    for( let ev of events )\r\n        ev.callback.call( ev.ctx, a, b, c );\r\n}\r\n\r\nfunction _fireEvent4( events : EventHandler[], a, b, c, d ) : void {\r\n    for( let ev of events )\r\n        ev.callback.call( ev.ctx, a, b, c, d );\r\n}\r\n\r\n// Subscrive for the single event\r\nfunction _on( _events : EventsSubscription, name : string, callback : Function, context : Object, ctx? : Object ){\r\n    const events = _events[ name ],\r\n          handler = new EventHandler( context, ctx || context, null, callback );\r\n\r\n    if( events ){\r\n        events.push( handler );\r\n    }\r\n    else{\r\n        _events[ name ] = [ handler ];\r\n    }\r\n};\r\n\r\n// Remove all events with a given name and context, or callback, if its provided. \r\nfunction _off( _events : EventsSubscription, name : string, callback : Function, context : {} ) {\r\n    const events = _events[ name ];\r\n\r\n    if( events ) {\r\n        const retain = [];\r\n\r\n        for ( let ev of events ) {\r\n            if( ( callback && callback !== ev.callback ) || context !== ev.context ) {\r\n                retain.push(ev);\r\n            }\r\n        }\r\n\r\n        _events[ name ] = retain.length ? retain : void 0;\r\n    }\r\n};\r\n\r\nconst _bubblingHandlers = {};\r\n\r\nfunction getBubblingHandler( event : string ){\r\n    return _bubblingHandlers[ event ] || (\r\n        _bubblingHandlers[ event ] = function( a, b, c ){\r\n            switch( arguments.length ){\r\n                // Forward call to monomorphic fast-path functions.\r\n                case 0 : trigger0( this, event ); break;\r\n                case 1 : trigger1( this, event, a ); break;\r\n                case 2 : trigger2( this, event, a, b ); break;\r\n                case 3 : trigger3( this, event, a, b, c ); break;\r\n                default :\r\n                    const args = [ event, a, b, c ];\r\n\r\n                    for( let i = 3; i < arguments.length; i++ ){\r\n                        args.push( arguments[ i ] );\r\n                    }\r\n\r\n                    this.trigger.apply( this, args );\r\n            }\r\n        }\r\n    );\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/events-api.ts\n **/"],"sourceRoot":""}